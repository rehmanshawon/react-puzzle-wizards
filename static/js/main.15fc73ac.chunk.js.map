{"version":3,"sources":["logo.png","App.js","reportWebVitals.js","index.js"],"names":["App","useState","crossTitle","setCrossTitle","crossWords","setCrossWords","hiddenTitle","setHideenTitle","hiddenMessage","setHiddenMessage","hiddenSearchWords","setHiddenSearchWords","searchTitle","setSearchTitle","letterAcross","setAcross","letterDown","setDown","searchOption","setSearchOption","caseOption","setCaseOption","searchWords","setSearchWords","doubleTitle","setDoubleTitle","doubleWords","setDoubleWords","finalWord","setFinalWord","doubleOption","setDoubeOption","fallenTitle","setFallenTitle","fallenWords","setFallenWords","fallenClueNo","setFallenClueNo","cryptoTitle","setCryptoTitle","cryptoPhrase","setCryptoPhrase","cryptoOption","setCryptoOption","cryptoClues","setCryptoClues","letterTitle","setLetterTitle","letterPhrase","setLetterPhrase","numberOfLetter","setNumberOfLetter","showLetterAnswerArea","setShowLetterAnswerArea","mathTitle","setMathTitle","squireSize","setSquireSize","mathClueNo","setMathClueNo","opAddition","setOpAddition","opSubtraction","setOpSubtraction","opMultiiplication","setOpMultiiplication","opDivision","setOpDivision","upperNumber","setUpperNumber","numberBlocksTitle","setNumberBlocksTitle","blockSize","setBlockSize","minNumber","setMinNumber","maxNumber","setMaxNumber","numberBlockClueNo","setNumberBlockClueNo","putInstructions","setPutInstructions","currentPuzzle","useRef","currentSettings","cryptoPhraseNoSpace","searchGrid","crosslines","hiddenAnswerPoints","grid","crossline","x1","y1","x2","y2","grid_size","search_grid_size","wordPlaced","direction","horizontalPoints","verticalPoints","hints","wordsOriginal","fallenPhrase","strippedFallenPhrase","fallenClueLetters","scrambledLetterGroup","letterGroup","downCount","cellXY","cellYX","acrossNums","downNums","crossInstructiions","hiddenInstructions","doubleInstructions","fallenInstructions","mathInstructions","letterInstructions","numberBlockInstructions","cryptoInstructions","words","resetCanvas","document","getElementById","style","visibility","innerText","printPuzzle","dataUrl","toDataURL","windowContent","innerHTML","elem","append","delimiter","printSection","createElement","id","appendChild","printElement","window","print","writeClipCanvas","canvas","img","src","div","contentEditable","body","element","createTextRange","range","moveToElementText","select","getSelection","selection","createRange","selectNodeContents","removeAllRanges","addRange","SelectText","execCommand","removeChild","preparePuzzle","instructions","clues","puzzle","display","clueDiv","para","setAttribute","dv","length","makeCrossWords","a","offsetHeight","top","toString","ctx","getContext","canvas2","ctx2","clearRect","width","height","font","textBaseline","fillStyle","textAlign","startX","startY","numberGrid","rowSum","colSum","diag1","diag2","clueIdx","cellWidth","cellHeight","beginPath","row","sum","col","randomInteger","Math","floor","random","push","i","clueCells","matching","j","rect","fillText","stroke","n","makeNumberBlockPuzzle","numberOfCellsInARow","numberOfRow","lastRowColumn","letterWidth","answerStartY","cText","split","join","originalText","makeLetterPuzzle","mathGridSize","mathGrid","mathAnswerGrid","arr","r","indexOf","mul","divide","ops","opsWithoutDiv","c","rightResult","bottomResult","equation","op","m","res","splice","giveAwayNo","fillRect","rc","max","answerX","answerY","makeMathPuzzle","iChars","fallenLetterGrid","fallenArray","charAt","toUpperCase","startClueY","idx","upperFallenPhrase","undefined","slice","makeFallenPuzzle","finalY","letterMatrix","singleSpaceString","replace","trim","uniqueLetterWords","string","filter","item","pos","self","allWords","finalString","matchedString","groupLetter","smallLetterPos","l","z","shuf","shuffle","letter","p","q","includes","k","randomPosition","wordInWords","letterInWord","arc","PI","console","log","wl","finalIndices","positionInWords","matched","makeDoublePuzzle","makeCryptogram","makeHiddenMessage","makeWordSearch","prepareSettings","puzzleSettings","current","clearCanvas","wrapText","context","text","x","y","maxWidth","lineHeight","line","testLine","measureText","randomIntFromInterval","min","reverseString","str","newString","repeatStringNumTimes","times","repeatedString","isCharacterALetter","char","test","useEffect","String","prototype","this","tmp","lineWidth","puzzle_words","toLowerCase","R","C","cellSize","orientations","word","word_length","placed","orientation","step_x","step_y","x_position","y_position","ending_x","ending_y","failed","character","new_position_x","new_position_y","character_at_new_position","randomChars","click","puzzle_words_string","helpString","processHiddenMessage","message","alert","area","value","firstLine","regex","messageToPlace","map","v","round","isEmpty","isLetter","letterAt","putLetterAtVertically","putCellVertically","putLetterAtHorizontally","putCellHorizontally","isCleanHeadAcross","head","isCleanHeadDown","isCleanTailAcross","isCleanTailDown","touchTopAcross","len","u","grid_word","reverse","touchBottomAcross","touchleftDown","touchRightDown","isValidCrossAcross","isValidCrossDown","placeWordAcross","index","number","cxy","putNumberHorizontally","placeWordDown","putNumberVertically","canPlaceOnGridCross","result","matchHorPoints","xp","yp","addVerPoints","canPlaceCrossDown","matchVerPoints","addHorPoints","canPlaceCrossAcross","canPlaceOnGridIsolate","isOverlappingDown","answer","isValidIsolateDown","canPlaceIsolateDown","isOverlappingAcross","isValidIsolateAcross","canPlaceIsolateAcross","point","matchingPoints","isolateCount","sort","b","counter","currentDirection","processFallenWords","lines","letter28","substring","extraEmptyChars","leftOver","padding","fineLine","count","randomCharIndex","sameChar","processLetterTiles","scrambledPhrase","processCryptoWords","noPunc","removeSpace","alphabet","shuffledAlphabet","cellIndex","lettersPerLine","lineNo","cl","cryptoPhraseUpper","moveTo","lineTo","className","logo","alt","onClick","e","type","size","placeholder","onChange","pre","target","name","rows","cols","spellCheck","href","ev","preventDefault","data","checked","htmlFor","word_hint","processCrossWords","ip","processDoubleWords","processSearchWords","answerCanvas","puzzleCanvas","btnAnswer","showCrossAnswer","strokeStyle","showSearchAnswer","showDoubleAnswer","showFallenAnswer","showMathAnswer","showLetterAnswer","showNumberAnswer","showCryptoAnswer","showHiddenAnswer","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.15fc73ac.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.a2353dc9.png\";","import React from \"react\";\nimport { useState, useRef, useEffect } from \"react\";\nimport \"./App.css\";\nimport logo from \"./logo.png\";\n\n/*MIT License\n\nCopyright (c) 2021 Mahfujur Rahman Shawon\nAuthor - Mahfujur Rahman Shawon\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nfunction App() {\n  const [crossTitle, setCrossTitle] = useState(\"New Criss-Cross Puzzle\");\n  const [crossWords, setCrossWords] = useState(\"\");\n  // state variables for hidden message puzzle\n  const [hiddenTitle, setHideenTitle] = useState(\"\");\n  const [hiddenMessage, setHiddenMessage] = useState(\"\");\n  const [hiddenSearchWords, setHiddenSearchWords] = useState(\"\");\n  // state variables for word-search puzzle\n  const [searchTitle, setSearchTitle] = useState(\"New Word Search Puzzle\");\n  const [letterAcross, setAcross] = useState(15);\n  const [letterDown, setDown] = useState(15);\n  const [searchOption, setSearchOption] = useState(2);\n  const [caseOption, setCaseOption] = useState(1);\n  const [searchWords, setSearchWords] = useState(\"Enter puzzle words or clues\");\n  // state variables for double puzzle\n  const [doubleTitle, setDoubleTitle] = useState(\"New Double Puzzle\");\n  const [doubleWords, setDoubleWords] = useState(\"\");\n  const [finalWord, setFinalWord] = useState(\"Enter Final Word or Phrase\");\n  const [doubleOption, setDoubeOption] = useState(2);\n  // state variables for fallen phrase puzzle\n  const [fallenTitle, setFallenTitle] = useState(\"New Fallen Phrase Puzzle\");\n  const [fallenWords, setFallenWords] = useState(\"\");\n  const [fallenClueNo, setFallenClueNo] = useState(10);\n  // state variables for cryptogram puzzle\n  const [cryptoTitle, setCryptoTitle] = useState(\"New Cryptogram Puzzle\");\n  const [cryptoPhrase, setCryptoPhrase] = useState(\"\");\n  const [cryptoOption, setCryptoOption] = useState(1);\n  const [cryptoClues, setCryptoClues] = useState(\"\");\n  // state variables for letter tiles puzzle\n  const [letterTitle, setLetterTitle] = useState(\"New Letter Tiles Puzzle\");\n  const [letterPhrase, setLetterPhrase] = useState(\"\");\n  const [numberOfLetter, setNumberOfLetter] = useState(3);\n  const [showLetterAnswerArea, setShowLetterAnswerArea] = useState(true);\n  // state variables for math square puzzle\n  const [mathTitle, setMathTitle] = useState(\"New Math Squares Title\");\n  const [squireSize, setSquireSize] = useState(3);\n  const [mathClueNo, setMathClueNo] = useState(2);\n  const [opAddition, setOpAddition] = useState(true);\n  const [opSubtraction, setOpSubtraction] = useState(true);\n  const [opMultiiplication, setOpMultiiplication] = useState(true);\n  const [opDivision, setOpDivision] = useState(true);\n  const [upperNumber, setUpperNumber] = useState(9);\n  // state variables for number block puzzle\n  const [numberBlocksTitle, setNumberBlocksTitle] = useState(\n    \"New Number Blocks Title\"\n  );\n  const [blockSize, setBlockSize] = useState(4);\n  const [minNumber, setMinNumber] = useState(0);\n  const [maxNumber, setMaxNumber] = useState(5);\n  const [numberBlockClueNo, setNumberBlockClueNo] = useState(2);\n\n  const [putInstructions, setPutInstructions] = useState(true);\n\n  const currentPuzzle = useRef(null);\n  const currentSettings = useRef(\"\");\n  const cryptoPhraseNoSpace = useRef(\"\");\n  const searchGrid = useRef([]);\n  const crosslines = useRef([]);\n  const hiddenAnswerPoints = useRef([]);\n\n  var grid = [];\n  var crossline = { x1: 0, y1: 0, x2: 0, y2: 0 };\n  var grid_size = 30;\n  var search_grid_size = 15;\n  var grid_end = grid_size - 1;\n  var grid_start = 0;\n  var wordPlaced = [];\n  var direction = [\"across\", \"down\"];\n  var horizontalPoints = [];\n  var verticalPoints = [];\n  var hints = [];\n  var wordsOriginal = [];\n  var fallenPhrase = [];\n  var strippedFallenPhrase = [];\n  var fallenClueLetters = [];\n  var scrambledLetterGroup = [];\n  var letterGroup = [];\n  var downCount = 0;\n  var cellXY = [];\n  var cellYX = [];\n  var acrossNums = [];\n  var downNums = [];\n  var crossInstructiions =\n    \"<h4>Instructions</h4><p>Use the clues to fill in the words below. Words can go across or down. Letters are shared when the words intersect.</p>\";\n  var searchInstructions = \"\";\n  var hiddenInstructions =\n    \"<h4>This puzzle is a word search puzzle that has a hidden message in it.</h4><p>First find all the words in the list.</p><p>Words can go in any direction and share letters as well as cross over each other.</p><p>Once you find all the words. Copy the unused letters starting in the top left corner into the blanks to reveal the hidden message.</P>\";\n  var doubleInstructions =\n    \"<h4>Solve the anagrams to reveal the letters for the final message</h4><p>Solve the anagrams in the top part of the puzzle.</p><p>Use the circled letters from the words in the top part to complete the final word or phrase at the bottom.</p><p>Each circled letter is used just once.</p><p>In case of numbered option, take the numbered letters and put them in the final phrase in their corresponding numbered cells</p>\";\n  var fallenInstructions =\n    \"<h4>Instructions</h4><p>The letters from each cell are below the puzzle. Try to rebuild the original message by choosing the letters for each cell.</p>\";\n  var mathInstructions =\n    \"<h4>Instructions</h4> <h5>Fill in the missing numbers</h5><p> The missing values are the whole numbers between 1 and \" +\n    upperNumber +\n    \". </p><p> Each number is only used once.</p><p> Each row is a math equation.</p><p> Each column is a math equation.</p><p> Remember that multiplication and division are performed before addition and subtraction.</p>\";\n  var letterInstructions =\n    \"<h4>Unscramble the tiles to reveal a message.</h4><p>Each tile is used only once.</p><p>Use spacing, puncuation and common words to find adjacent tiles.</p><p>Some words may be split into two lines.</p>\";\n  var numberBlockInstructions =\n    \"<h4>Fill in the missing numbers</h4><p>The missing numbers are integers between 0 and 5.</p><p>The numbers in each row add up to totals to the right.</p><p>The numbers in each column add up to the totals along the bottom.</p><p>The diagonal lines also add up the totals to the right.</p>\";\n  var cryptoInstructions =\n    \"<h4>Decode the message.</h4><p>Each letter in the phrase has been replaced with a random letter or number.</p><p>Try to decode the message.</p>\";\n  var words = [\n    \"elephant\",\n    \"tiger\",\n    \"lion\",\n    \"cat\",\n    \"zebra\",\n    \"penguin\",\n    \"rhino\",\n    \"monkey\",\n    \"leopard\",\n    \"kangaroo\",\n    \"bird\",\n    \"giraff\",\n    \"bison\",\n    \"dinosaur\",\n    \"chitah\",\n    \"python\",\n    \"snake\",\n\n    \"redemption\",\n    \"school\",\n    \"forrest\",\n    \"remember\",\n    \"private\",\n    \"knight\",\n    \"father\",\n    \"fiction\",\n    \"fight\",\n    \"beautiful\",\n    \"history\",\n    \"story\",\n    \"future\",\n    \"lost\",\n  ];\n\n  // one time hook to set word search puzzle the default opened puzzle\n  // this hook is called when the page loads\n  useEffect(() => {\n    prepareSettings(\"search-settings\");\n    currentPuzzle.current = \"search\";\n  }, []);\n\n  // hides puzzle answer and shows the puzzle back\n  function resetCanvas() {\n    document.getElementById(\"answer-canvas\").style.visibility = \"hidden\";\n    document.getElementById(\"puzzle-canvas\").style.visibility = \"visible\";\n    document.getElementById(\"btnAnswer\").innerText = \"SHOW ANSWER\";\n  }\n\n  // sends puzzle to printer\n  function printPuzzle() {\n    var dataUrl = document.getElementById(\"puzzle-canvas\").toDataURL(); //attempt to save base64 string to server using this var\n    var windowContent = \"\";\n    windowContent += \"<h1>Print Puzzle</h1>\";\n    windowContent += document.getElementById(\"puzzle-instructions\").innerHTML;\n    windowContent += '<img src=\"' + dataUrl + '\">';\n    printElement(null, true, windowContent);\n    window.print();\n    var printSection = document.getElementById(\"printSection\");\n    printSection.innerHTML = \"\";\n  }\n  // print helper function\n  function printElement(elem, append, delimiter) {\n    var printSection = document.getElementById(\"printSection\");\n    if (!printSection) {\n      printSection = document.createElement(\"div\");\n      printSection.id = \"printSection\";\n      document.getElementById(\"app\").appendChild(printSection);\n    }\n    if (append !== true) {\n      printSection.innerHTML = \"\";\n    } else if (append === true) {\n      if (typeof delimiter === \"string\") {\n        printSection.innerHTML += delimiter;\n      } else if (typeof delimiter === \"object\") {\n        printSection.appendChild(delimiter);\n      }\n    }\n  }\n  // helper function to copy puzzle\n  function SelectText(element) {\n    var doc = document;\n    if (doc.body.createTextRange) {\n      var range = document.body.createTextRange();\n      range.moveToElementText(element);\n      range.select();\n    } else if (window.getSelection) {\n      var selection = window.getSelection();\n      range = document.createRange();\n      range.selectNodeContents(element);\n      selection.removeAllRanges();\n      selection.addRange(range);\n    }\n  }\n  // canvas copier function\n  function writeClipCanvas(id) {\n    var canvas = document.getElementById(id);\n    var img = document.createElement(\"img\");\n    img.src = canvas.toDataURL();\n    var div = document.createElement(\"div\");\n    div.contentEditable = true;\n    div.appendChild(img);\n    document.body.appendChild(div);\n    // do copy\n    SelectText(div);\n    document.execCommand(\"Copy\");\n    document.body.removeChild(div);\n  }\n\n  // this function prepares div which contains the puzzle canvas and\n  // other buttons and instructions\n  // and calls the puzzle making function sent in the puzzle parameter\n  function preparePuzzle(instructions, clues, puzzle) {\n    // display necessary settings button and instruction divs\n    document.getElementById(\"puzzle-operations\").style.display = \"block\";\n    document.getElementById(\"puzzle-instructions\").style.display = \"block\";\n    document.getElementById(\"puzzle-instructions\").innerHTML = \"\";\n    document.getElementById(\"puzzle-instructions\").innerHTML += instructions;\n    // make the puzzle user clicked for.\n    if (puzzle === \"search\") {\n      makeWordSearch();\n      return;\n    }\n    if (puzzle === \"hidden\") {\n      makeHiddenMessage();\n      return;\n    }\n    if (puzzle === \"crypto\") {\n      makeCryptogram();\n      return;\n    }\n    // a little bit of work needed for the cross-word puzzle instructions because you never know which\n    // words will be across and which will be down.\n    if (puzzle === \"cross\") {\n      var clueDiv = document.getElementById(\"puzzle-clues\");\n      clueDiv.innerHTML = \"\";\n      var para = document.createElement(\"P\"); // Create a <p> element\n      para.innerText = \"Across\"; // Insert text\n      para.setAttribute(\"class\", \"pmedium\");\n      clueDiv.appendChild(para); // Append <p> to <body>\n      var dv = document.createElement(\"DIV\");\n      dv.setAttribute(\"id\", \"across\");\n      clueDiv.appendChild(dv);\n      para = document.createElement(\"P\");\n      para.innerText = \"Down\"; // Insert text\n      para.setAttribute(\"class\", \"pmedium\");\n      clueDiv.appendChild(para);\n      dv = document.createElement(\"DIV\");\n      dv.setAttribute(\"id\", \"down\");\n      clueDiv.appendChild(dv);\n      wordPlaced = [];\n      downCount = 0;\n      while (downCount !== words.length / 2) {\n        wordPlaced = [];\n        while (wordPlaced.length !== words.length) {\n          makeCrossWords();\n        }\n      }\n      var a = document.getElementById(\"puzzle-canvas\").offsetHeight;\n      a += document.getElementById(\"puzzle-instructions\").offsetHeight;\n      a += document.getElementById(\"puzzle-operations\").offsetHeight;\n      a += 100;\n      document.getElementById(\"puzzle-clues\").style.top = a.toString() + \"px\";\n      document.getElementById(\"puzzle-clues\").style.display = \"block\";\n      return;\n    }\n    if (puzzle === \"double\") {\n      makeDoublePuzzle();\n      return;\n    }\n    if (puzzle === \"fallen\") {\n      makeFallenPuzzle();\n      return;\n    }\n    if (puzzle === \"math\") {\n      makeMathPuzzle();\n      return;\n    }\n    if (puzzle === \"letter\") {\n      makeLetterPuzzle();\n      return;\n    }\n    if (puzzle === \"number\") {\n      makeNumberBlockPuzzle();\n      return;\n    }\n  }\n\n  // this function shows the settings window where user can set parameters\n  // to create the puzzle of their choice.\n  // But before that it resets the canvas and other stuff.\n  function prepareSettings(puzzleSettings) {\n    document.getElementById(\"puzzle-operations\").style.display = \"none\";\n    document.getElementById(\"puzzle-instructions\").style.display = \"none\";\n    document.getElementById(\"puzzle-clues\").style.display = \"none\";\n    document.getElementById(\"answer-canvas\").style.visibility = \"hidden\";\n    if (currentSettings.current !== \"\")\n      document.getElementById(currentSettings.current).style.display = \"none\";\n    document.getElementById(puzzleSettings).style.display = \"block\";\n    currentSettings.current = puzzleSettings;\n  }\n\n  // this function clear the two canvases for showing a new puzzle\n  function clearCanvas() {\n    var btnPuzzle = document.getElementById(\"btnReload\");\n    btnPuzzle.innerHTML = \"RELOAD PUZZLE\";\n    var btnAnswer = document.getElementById(\"btnAnswer\");\n    btnAnswer.innerHTML = \"SHOW ANSWER\";\n    var canvas = document.getElementById(\"answer-canvas\");\n    var ctx = canvas.getContext(\"2d\");\n    var canvas2 = document.getElementById(\"puzzle-canvas\");\n    var ctx2 = canvas2.getContext(\"2d\");\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx2.clearRect(0, 0, canvas2.width, canvas2.height);\n  }\n\n  // remove duplicate characters from a string\n  function removeDuplicateCharacters(string) {\n    return string\n      .split(\"\")\n      .filter(function (item, pos, self) {\n        return self.indexOf(item) === pos;\n      })\n      .join(\"\");\n  }\n  // shuffles s string\n  String.prototype.shuffle = function () {\n    var a = this.split(\"\"),\n      n = a.length;\n\n    for (var i = n - 1; i > 0; i--) {\n      var j = Math.floor(Math.random() * (i + 1));\n      var tmp = a[i];\n      a[i] = a[j];\n      a[j] = tmp;\n    }\n    return a.join(\"\");\n  };\n  // a custom html5 canvas text wrapper function\n  function wrapText(context, text, x, y, maxWidth, lineHeight) {\n    var words = text.split(\" \");\n    var line = \"\";\n    for (var n = 0; n < words.length; n++) {\n      var testLine = line + words[n] + \" \";\n      var metrics = context.measureText(testLine);\n      var testWidth = metrics.width;\n      if (testWidth > maxWidth && n > 0) {\n        context.fillText(line, x, y);\n        line = words[n] + \" \";\n        y += lineHeight;\n      } else {\n        line = testLine;\n      }\n    }\n    context.fillText(line, x, y);\n  }\n\n  // custom random integer functions\n  function randomIntFromInterval(min, max) {\n    // min and max included\n    return Math.floor(Math.random() * (max - min + 1) + min);\n  }\n  // function to remove punctuation marks and replace them with a single space\n  function removePunctuations(str) {\n    const punctuationless = str.replace(/[^\\w\\s]|_/g, \"\").replace(/\\s+/g, \" \");\n    return punctuationless;\n  }\n  // function to remove space from a string\n  function removeSpace(str) {\n    const noSpace = str.replace(/\\s+/g, \"\");\n    return noSpace;\n  }\n  // reverses a string\n  function reverseString(str) {\n    var newString = \"\";\n    for (var i = str.length - 1; i >= 0; i--) {\n      newString += str[i];\n    }\n    return newString;\n  }\n  // repeat a given string number of times and return the output\n  function repeatStringNumTimes(string, times) {\n    var repeatedString = \"\";\n    while (times > 0) {\n      repeatedString += string;\n      times--;\n    }\n    return repeatedString;\n  }\n  // checks if character is a letter\n  function isCharacterALetter(char) {\n    return /[a-zA-Z]/.test(char);\n  }\n  /*********Word Search Puzzle Code Starts Here */\n  /*\n  1. processSearchWords()\n  2. makeWordSearch()\n  3. showSearchAnswer()\n  */\n  function processSearchWords() {\n    // get textarea data\n    var area = document.getElementById(\"search-words\");\n    // strip extra places, trim extra spaces from begin and start and then split the text by single words\n    var wrds = area.value.replace(/\\s+/g, \" \").trim().split(\" \");\n    if (wrds.length < 10) {\n      alert(\"Give at least 10 words\");\n      return false;\n    }\n    // store refined text in state variable\n    setSearchWords(area.value.replace(/\\s+/g, \" \").trim());\n    return true;\n  }\n  const makeWordSearch = () => {\n    // get 2d canvas context first\n    var canvas = document.getElementById(\"puzzle-canvas\");\n    var ctx = canvas.getContext(\"2d\");\n    // set drawing styles\n    ctx.lineWidth = 2;\n    ctx.font = \"14px verdana\";\n    ctx.textBaseline = \"middle\";\n    ctx.fillStyle = \"black\";\n    ctx.textAlign = \"center\";\n\n    // clear canvas\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    // change case of the words according to what user selected\n    if (caseOption === 1) {\n      var puzzle_words = searchWords.toUpperCase().split(\" \");\n    }\n    if (caseOption === 2) {\n      puzzle_words = searchWords.split(\" \");\n    }\n    if (caseOption === 3) {\n      puzzle_words = searchWords.toLowerCase().split(\" \");\n    }\n\n    // set the grid size from user input - row = column\n    search_grid_size = letterAcross;\n\n    const R = letterAcross,\n      C = letterDown;\n    const val = \"_\";\n    // set the cell size\n    const cellSize = 20;\n    // empty the searchGrid\n    searchGrid.current = [];\n    // initialize the grid with \"_\"\n    for (var i = 0; i < R; i++) {\n      searchGrid.current[i] = [];\n      for (var j = 0; j < C; j++) {\n        searchGrid.current[i][j] = val;\n      }\n    }\n    crosslines.current = []; // clear cross-out data\n    // define orientations\n    var orientations = [\"leftright\", \"updown\", \"diagonalup\", \"diagonaldown\"];\n\n    // global loop for placing the words on puzzle\n    for (var n = 0; n < puzzle_words.length; n++) {\n      var word = puzzle_words[n];\n      var word_length = puzzle_words[n].length;\n      var placed = false;\n      while (!placed) {\n        // get random orientations\n        var orientation =\n          orientations[Math.floor(Math.random() * orientations.length)];\n        // select the step values according to orientations\n        // step values determine which direction a word will spread\n        if (orientation === \"leftright\") {\n          var step_x = 1;\n          var step_y = 0;\n        }\n        if (orientation === \"updown\") {\n          step_x = 0;\n          step_y = 1;\n        }\n        if (orientation === \"diagonalup\") {\n          step_x = 1;\n          step_y = -1;\n        }\n        if (orientation === \"diagonaldown\") {\n          step_x = 1;\n          step_y = 1;\n        }\n        //these will be the direction choices and what happens with eacth . . .\n        // make sure this is still in the while loop!\n        // here we are just choosing a starting point for the word . . .\n        var x_position = randomIntFromInterval(0, search_grid_size - 1);\n        var y_position = randomIntFromInterval(0, search_grid_size - 1);\n        // now we have to figure out if we can fit the word at this position\n        var ending_x = x_position + word_length * step_x;\n        var ending_y = y_position + word_length * step_y;\n        if (ending_x < 0 || ending_x >= search_grid_size) continue;\n        if (ending_y < 0 || ending_y >= search_grid_size) continue;\n        // if we fall outside the dimensions of the grid in either direction\n        // then we should restart the check . . . choose a new orientation and try again\n        // otherwise, lets place the word\n        // again checking with a boolean value\n        var failed = false;\n        // We do two things here\n        // this first for loop determines whether or not we can realistically\n        // place the word here. If every letter in the word has a free space\n        // on the grid (denoted by the underscore), then we can use this setup\n        // If it fails that test, we break out this for loop and continue on the bigger\n        // while loop (choose a new orientation)\n        for (i = 0; i < word_length; i++) {\n          var character = word[i];\n          var new_position_x = x_position + i * step_x;\n          var new_position_y = y_position + i * step_y;\n          var character_at_new_position =\n            searchGrid.current[new_position_x][new_position_y];\n          if (character_at_new_position !== \"_\") {\n            if (character_at_new_position === character) continue;\n            else {\n              failed = true;\n              break;\n            }\n          }\n        }\n        if (failed) continue;\n        else {\n          for (var k = 0; k < word_length; k++) {\n            character = word[k];\n            new_position_x = x_position + k * step_x;\n            new_position_y = y_position + k * step_y;\n            searchGrid.current[new_position_x][new_position_y] = character;\n            ctx.fillText(\n              searchGrid.current[new_position_x][new_position_y],\n              new_position_x * cellSize + cellSize / 2,\n              new_position_y * cellSize + cellSize / 2\n            );\n            // cross-out lines will be shown as answer to the puzzles\n            // store the cross-out line's starting coordinates\n            if (k === 0) {\n              crossline.x1 = new_position_x * cellSize + cellSize / 2;\n              crossline.y1 = new_position_y * cellSize + cellSize / 2;\n            }\n            // store the cross-out line's ending coordinates\n            if (k === word_length - 1) {\n              crossline.x2 = new_position_x * cellSize + cellSize / 2;\n              crossline.y2 = new_position_y * cellSize + cellSize / 2;\n            }\n          }\n          // save line coordinates to global ref\n          crosslines.current.push({\n            x1: crossline.x1,\n            y1: crossline.y1,\n            x2: crossline.x2,\n            y2: crossline.y2,\n          });\n          placed = true;\n        }\n      }\n    }\n\n    // next populate the empty positions of the grid with random letters\n    if (caseOption === 1) var randomChars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n    if (caseOption === 2) randomChars = \"AbCdEfGhIjKlMnOpQrStUvWxYz\";\n    if (caseOption === 3) randomChars = \"abcdefghijklmnopqrstuvwxyz\";\n    for (var row = 0; row < search_grid_size; row++) {\n      for (var col = 0; col < search_grid_size; col++) {\n        if (searchGrid.current[row][col] === \"_\") {\n          searchGrid.current[row][col] = randomChars.charAt(\n            Math.floor(Math.random() * randomChars.length)\n          );\n          ctx.fillText(\n            searchGrid.current[row][col],\n            row * cellSize + cellSize / 2,\n            col * cellSize + cellSize / 2\n          );\n        }\n      }\n    }\n\n    // if reload or create puzzle clicked again, then reset the show answer button\n    if (document.getElementById(\"btnAnswer\").innerText === \"HIDE ANSWER\") {\n      document.getElementById(\"btnAnswer\").click();\n    }\n\n    // write the puzzle instructions below the puzzle\n    var puzzle_words_string = \"\";\n    for (var q = 0; q < puzzle_words.length; q++) {\n      puzzle_words_string += puzzle_words[q] + \"   \";\n    }\n    var maxWidth = 500;\n    var lineHeight = 25;\n    var x = 10;\n    var y = search_grid_size * cellSize + 50;\n    ctx.textAlign = \"left\";\n    ctx.font = \"20px verdana\";\n    ctx.fillText(\"Find the words below\", x, y);\n    ctx.font = \"14px verdana\";\n    var helpString = \"Words can go in any direction. \\n\";\n    helpString += \"Words can share letters as they cross over each other.\";\n    wrapText(ctx, helpString, x, y + 30, maxWidth, lineHeight);\n    ctx.font = \"16px verdana\";\n    wrapText(ctx, puzzle_words_string, x, y + 80, maxWidth, lineHeight);\n  };\n\n  // function to show answer of the word-search puzzle\n  function showSearchAnswer() {\n    // get context of the answer canvas and reset parameters\n    var answerCanvas = document.getElementById(\"answer-canvas\");\n    var puzzleCanvas = document.getElementById(\"puzzle-canvas\");\n    var btnAnswer = document.getElementById(\"btnAnswer\");\n    if (btnAnswer.innerText === \"SHOW ANSWER\")\n      puzzleCanvas.style.visibility = \"hidden\";\n    else {\n      document.getElementById(\"answer-canvas\").style.visibility = \"hidden\";\n      puzzleCanvas.style.visibility = \"visible\";\n      btnAnswer.innerText = \"SHOW ANSWER\";\n      return;\n    }\n    btnAnswer.innerText = \"HIDE ANSWER\";\n    answerCanvas.style.visibility = \"visible\";\n    var context = answerCanvas.getContext(\"2d\");\n    context.lineWidth = 2;\n    context.font = \"14px verdana\";\n    context.textAlign = \"center\";\n    context.textBaseline = \"middle\";\n    context.fillStyle = \"black\";\n    // clear canvas first\n    context.clearRect(0, 0, answerCanvas.width, answerCanvas.height);\n    // set the cell size\n    const cellSize = 20;\n    // print the puzzle first\n    for (var row = 0; row < search_grid_size; row++) {\n      for (var col = 0; col < search_grid_size; col++) {\n        context.fillText(\n          searchGrid.current[row][col],\n          row * cellSize + cellSize / 2,\n          col * cellSize + cellSize / 2\n        );\n      }\n    }\n    // now print the cross-out lines from previously stored line coordinates.\n    //that's the answer.\n    for (var i = 0; i < crosslines.current.length; i++) {\n      context.beginPath();\n      context.moveTo(crosslines.current[i].x1, crosslines.current[i].y1);\n      context.lineTo(crosslines.current[i].x2, crosslines.current[i].y2);\n      context.lineWidth = 1;\n      context.strokeStyle = \"#000000\";\n      context.stroke();\n    }\n    // print the instructions below the puzzle\n    if (caseOption === 1)\n      var puzzle_words = searchWords.toUpperCase().split(\" \");\n    if (caseOption === 2) puzzle_words = searchWords.split(\" \");\n    if (caseOption === 3) puzzle_words = searchWords.toLowerCase().split(\" \");\n    var puzzle_words_string = \"\";\n    for (var q = 0; q < puzzle_words.length; q++) {\n      puzzle_words_string += puzzle_words[q] + \"   \";\n    }\n    var maxWidth = 500;\n    var lineHeight = 25;\n    var x = 10;\n    var y = search_grid_size * cellSize + 50;\n    context.textAlign = \"left\";\n    context.font = \"20px verdana\";\n    context.fillText(\"Find the words below\", x, y);\n    context.font = \"14px verdana\";\n    var helpString = \"Words can go in any direction. \\n\";\n    helpString += \"Words can share letters as they cross over each other.\";\n    wrapText(context, helpString, x, y + 30, maxWidth, lineHeight);\n    context.font = \"16px verdana\";\n    wrapText(context, puzzle_words_string, x, y + 80, maxWidth, lineHeight);\n  }\n\n  /*************** Hidden Message Puzzle Code Starts Here *******************/\n  /*\n  Hidden Message and Word Search Puzzles are almost same.\nFunctions that make this puzzle\n1. processHiddenMessage()\n2. makeHiddenMessage()\n3. showHiddenAnswer()\n*/\n  // function to process hidden message input from the user\n  function processHiddenMessage() {\n    var message = hiddenMessage.replace(/\\s+/g, \" \").trim();\n    if (message.length < 10) {\n      alert(\"Give at least 10 letters in the hidden message\");\n      return false;\n    }\n    setHiddenMessage(message);\n    var area = document.getElementById(\"hidden-search-words\");\n    var wrds = area.value.replace(/\\s+/g, \" \").trim().split(\" \");\n    if (wrds.length < 10) {\n      alert(\"Give at least 10 words\");\n      return false;\n    }\n    setHiddenSearchWords(area.value.replace(/\\s+/g, \" \").trim());\n    return true;\n  }\n  // function that makes Hidden Message Puzzle\n  const makeHiddenMessage = () => {\n    // get 2d drawing canvas context\n    var canvas = document.getElementById(\"puzzle-canvas\");\n    var ctx = canvas.getContext(\"2d\");\n    // initialize the context\n    ctx.lineWidth = 2;\n    ctx.font = \"14px verdana\";\n    ctx.textBaseline = \"middle\";\n    ctx.fillStyle = \"black\";\n    ctx.textAlign = \"center\";\n    // clear the canvas\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    // change case of the search words according to user input\n    if (caseOption === 1) {\n      var puzzle_words = hiddenSearchWords.toUpperCase().split(\" \");\n    }\n    if (caseOption === 2) {\n      puzzle_words = hiddenSearchWords.split(\" \");\n    }\n    if (caseOption === 3) {\n      puzzle_words = hiddenSearchWords.toLowerCase().split(\" \");\n    }\n    // initialize search grid size from user input\n    search_grid_size = letterAcross;\n    const R = letterAcross,\n      C = letterDown;\n    // initialize cell size\n    const cellSize = 20;\n    const val = \"_\";\n    // empty search grid\n    searchGrid.current = [];\n    // fill the grid with \"_\"\n    for (var i = 0; i < R; i++) {\n      searchGrid.current[i] = [];\n      for (var j = 0; j < C; j++) {\n        searchGrid.current[i][j] = val;\n      }\n    }\n\n    crosslines.current = []; // clear cross-out data\n    // initialize the orientations\n    var orientations = [\"leftright\", \"updown\", \"diagonalup\", \"diagonaldown\"];\n    // global loop to place the search words on the canvas\n    for (var n = 0; n < puzzle_words.length; n++) {\n      var word = puzzle_words[n];\n      var word_length = puzzle_words[n].length;\n      var placed = false;\n      var firstLine = false;\n      while (!placed) {\n        // get random orientation\n        var orientation =\n          orientations[Math.floor(Math.random() * orientations.length)];\n        // set step direction based on orientation\n        // step defines which direction the word will spread\n        if (orientation === \"leftright\") {\n          var step_x = 1;\n          var step_y = 0;\n        }\n        if (orientation === \"updown\") {\n          step_x = 0;\n          step_y = 1;\n        }\n        if (orientation === \"diagonalup\") {\n          step_x = 1;\n          step_y = -1;\n        }\n        if (orientation === \"diagonaldown\") {\n          step_x = 1;\n          step_y = 1;\n        }\n        //these will be the direction choices and what happens with eacth . . .\n        // make sure this is still in the while loop!\n        // here we are just choosing a starting point for the word . . .\n        var x_position = randomIntFromInterval(0, search_grid_size - 1);\n        var y_position = randomIntFromInterval(0, search_grid_size - 1);\n        if (x_position === 0 || y_position === 0) {\n          firstLine = true;\n        }\n        if (!firstLine) continue;\n        // now we have to figure out if we can fit the word at this position\n        var ending_x = x_position + word_length * step_x;\n        var ending_y = y_position + word_length * step_y;\n        if (ending_x < 0 || ending_x >= search_grid_size) continue;\n        if (ending_y < 0 || ending_y >= search_grid_size) continue;\n        // if we fall outside the dimensions of the grid in either direction\n        // then we should restart the check . . . choose a new orientation and try again\n        // otherwise, lets place the word\n        // again checking with a boolean value\n        var failed = false;\n        // We do two things here\n        // this first for loop determines whether or not we can realistically\n        // place the word here. If every letter in the word has a free space\n        // on the grid (denoted by the underscore), then we can use this setup\n        // If it fails that test, we break out this for loop and continue on the bigger\n        // while loop (choose a new orientation)\n        for (i = 0; i < word_length; i++) {\n          var character = word[i];\n          var new_position_x = x_position + i * step_x;\n          var new_position_y = y_position + i * step_y;\n          var character_at_new_position =\n            searchGrid.current[new_position_x][new_position_y];\n          if (character_at_new_position !== \"_\") {\n            if (character_at_new_position === character) continue;\n            else {\n              failed = true;\n              break;\n            }\n          }\n        }\n        if (failed) continue;\n        else {\n          for (var k = 0; k < word_length; k++) {\n            character = word[k];\n            new_position_x = x_position + k * step_x;\n            new_position_y = y_position + k * step_y;\n            searchGrid.current[new_position_x][new_position_y] = character;\n            ctx.fillText(\n              searchGrid.current[new_position_x][new_position_y],\n              new_position_x * cellSize + cellSize / 2,\n              new_position_y * cellSize + cellSize / 2\n            );\n            // cross-out lines are shown in the answer\n            // calculate the starting coordinates of the line\n            if (k === 0) {\n              crossline.x1 = new_position_x * cellSize + cellSize / 2;\n              crossline.y1 = new_position_y * cellSize + cellSize / 2;\n            }\n            // calculate the ending coordinate of the line\n            if (k === word_length - 1) {\n              crossline.x2 = new_position_x * cellSize + cellSize / 2;\n              crossline.y2 = new_position_y * cellSize + cellSize / 2;\n            }\n          }\n          // save the line to global array\n          crosslines.current.push({\n            x1: crossline.x1,\n            y1: crossline.y1,\n            x2: crossline.x2,\n            y2: crossline.y2,\n          });\n          // word placed. go to next word in the array\n          placed = true;\n        }\n      }\n    }\n    var regex = /[!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~]/g;\n    // next populate the empty positions of the grid with random letters\n    // befor that remove any unwanted puncutation marks from the phrase\n    if (caseOption === 1) {\n      var randomChars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n      var messageToPlace = hiddenMessage\n        .replace(/\\s/g, \"\")\n        .toUpperCase()\n        .replace(regex, \"\");\n    }\n    if (caseOption === 2) {\n      randomChars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n        .split(\"\")\n        .map((v) =>\n          Math.round(Math.random()) ? v.toUpperCase() : v.toLowerCase()\n        )\n        .join(\"\");\n      messageToPlace = hiddenMessage\n        .replace(/\\s/g, \"\")\n        .split(\"\")\n        .map((v) =>\n          Math.round(Math.random()) ? v.toUpperCase() : v.toLowerCase()\n        )\n        .join(\"\")\n        .replace(regex, \"\");\n    }\n    if (caseOption === 3) {\n      randomChars = \"abcdefghijklmnopqrstuvwxyz\";\n      messageToPlace = hiddenMessage\n        .replace(/\\s/g, \"\")\n        .toLowerCase()\n        .replace(regex, \"\");\n    }\n    n = 0;\n    // this is where hidden message letters' coordinates are saved for\n    // showing the answer in future\n    hiddenAnswerPoints.current = [];\n    // write the hidden message starting from first row and first column\n    // only the cell that has the letter \"_\" will get a letter from\n    // the hidden message\n    for (var row = 0; row < search_grid_size; row++) {\n      for (var col = 0; col < search_grid_size; col++) {\n        if (searchGrid.current[col][row] === \"_\") {\n          if (n < messageToPlace.length) {\n            // write the message letter to the grid\n            searchGrid.current[col][row] = messageToPlace[n];\n            // save the letter index for drawing circles around them when showing the answer\n            hiddenAnswerPoints.current.push([col, row]);\n            // write the message letter to the canvas\n            ctx.fillText(\n              searchGrid.current[col][row],\n              col * cellSize + cellSize / 2,\n              row * cellSize + cellSize / 2\n            );\n            n++;\n          }\n        }\n      }\n    }\n    // this loop fills up the remaining cells with random letter\n    for (row = 0; row < search_grid_size; row++) {\n      for (col = 0; col < search_grid_size; col++) {\n        if (searchGrid.current[col][row] === \"_\") {\n          searchGrid.current[col][row] = randomChars.charAt(\n            Math.floor(Math.random() * randomChars.length)\n          );\n          ctx.fillText(\n            searchGrid.current[col][row],\n            col * 20 + 20 / 2,\n            row * 20 + 20 / 2\n          );\n        }\n      }\n    }\n    // reset if puzzle reloads or recreated\n    if (document.getElementById(\"btnAnswer\").innerText === \"HIDE ANSWER\") {\n      document.getElementById(\"btnAnswer\").click();\n    }\n\n    // write the instruction bellow the puzzle\n    var puzzle_words_string = \"\";\n    for (var q = 0; q < puzzle_words.length; q++) {\n      puzzle_words_string += puzzle_words[q] + \"   \";\n    }\n    var maxWidth = 600;\n    var lineHeight = 25;\n    var x = 10;\n    var y = search_grid_size * cellSize + 50;\n    ctx.textAlign = \"left\";\n    ctx.font = \"20px verdana\";\n    wrapText(\n      ctx,\n      \"Write the hidden message below after finding the words in the list\",\n      x,\n      y,\n      maxWidth,\n      lineHeight\n    );\n    for (q = 0; q < hiddenMessage.length; q++) {\n      if (isCharacterALetter(hiddenMessage[q]))\n        ctx.fillText(\"_\", x + q * 20, y + 60);\n      else ctx.fillText(hiddenMessage[q], x + q * 20, y + 60);\n    }\n    ctx.font = \"16px verdana\";\n    wrapText(ctx, puzzle_words_string, x, y + 100, maxWidth, lineHeight);\n  };\n\n  // function to show answer for Hidden Phrase puzzle\n  function showHiddenAnswer() {\n    // get the canvas handles and show/hide them as user wants\n    var answerCanvas = document.getElementById(\"answer-canvas\");\n    var puzzleCanvas = document.getElementById(\"puzzle-canvas\");\n    var btnAnswer = document.getElementById(\"btnAnswer\");\n    if (btnAnswer.innerText === \"SHOW ANSWER\")\n      puzzleCanvas.style.visibility = \"hidden\";\n    else {\n      document.getElementById(\"answer-canvas\").style.visibility = \"hidden\";\n      puzzleCanvas.style.visibility = \"visible\";\n      btnAnswer.innerText = \"SHOW ANSWER\";\n      return;\n    }\n    btnAnswer.innerText = \"HIDE ANSWER\";\n    answerCanvas.style.visibility = \"visible\";\n    // get context of answer canvas\n    var context = answerCanvas.getContext(\"2d\");\n    // initialize it\n    context.lineWidth = 2;\n    context.font = \"14px verdana\";\n    context.textAlign = \"center\";\n    context.textBaseline = \"middle\";\n    context.fillStyle = \"black\";\n    // clear the canvas\n    context.clearRect(0, 0, answerCanvas.width, answerCanvas.height);\n\n    const cellSize = 20;\n    // draw the grid with it's letters\n    for (var row = 0; row < search_grid_size; row++) {\n      for (var col = 0; col < search_grid_size; col++) {\n        context.fillText(\n          searchGrid.current[row][col],\n          row * cellSize + cellSize / 2,\n          col * cellSize + cellSize / 2\n        );\n      }\n    }\n    // draw the cross-out lines on the answer\n    context.lineWidth = 1;\n    context.strokeStyle = \"#000000\";\n    for (var i = 0; i < crosslines.current.length; i++) {\n      context.beginPath();\n      context.moveTo(crosslines.current[i].x1, crosslines.current[i].y1);\n      context.lineTo(crosslines.current[i].x2, crosslines.current[i].y2);\n      context.stroke();\n    }\n    // draw a circle around each Hidden message letter depicting the true answer\n    context.beginPath();\n    for (i = 0; i < hiddenAnswerPoints.current.length; i++) {\n      context.beginPath();\n      context.arc(\n        hiddenAnswerPoints.current[i][0] * 20 + 20 / 2,\n        hiddenAnswerPoints.current[i][1] * 20 + 20 / 2,\n        10,\n        0,\n        2 * Math.PI\n      );\n      context.stroke();\n    }\n    // write instructions below the puzzle\n    if (caseOption === 1)\n      var puzzle_words = hiddenSearchWords.toUpperCase().split(\" \");\n    if (caseOption === 2) puzzle_words = hiddenSearchWords.split(\" \");\n    if (caseOption === 3)\n      puzzle_words = hiddenSearchWords.toLowerCase().split(\" \");\n    var puzzle_words_string = \"\";\n    for (var q = 0; q < puzzle_words.length; q++) {\n      puzzle_words_string += puzzle_words[q] + \"   \";\n    }\n    var maxWidth = 600;\n    var lineHeight = 25;\n    var x = 10;\n    var y = search_grid_size * cellSize + 50;\n    context.textAlign = \"left\";\n    context.font = \"20px verdana\";\n    wrapText(\n      context,\n      \"Write the hidden message below after finding the words in the list\",\n      x,\n      y,\n      maxWidth,\n      lineHeight\n    );\n\n    for (q = 0; q < hiddenMessage.length; q++) {\n      if (isCharacterALetter(hiddenMessage[q]))\n        context.fillText(\"_\", x + q * cellSize, y + 60);\n      else context.fillText(hiddenMessage[q], x + q * cellSize, y + 60);\n    }\n    context.font = \"16px verdana\";\n    wrapText(context, puzzle_words_string, x, y + 100, maxWidth, lineHeight);\n  }\n\n  /*********** Cross Words Puzzle Code Starts Here *****************/\n  // checks if a grid cell is empty\n  function isEmpty(x, y) {\n    return grid[y][x] === \"_\";\n  }\n  // checks if a grid cell contains a letter\n  function isLetter(x, y) {\n    return grid[y][x] !== \"_\";\n  }\n  // returns the letter from a grid cell\n  function letterAt(x, y) {\n    return grid[y][x];\n  }\n  //draws letter vertically on the canvas\n  function putLetterAtVertically(x, y, letter, ctx) {\n    ctx.fillStyle = \"white\";\n    ctx.beginPath();\n    ctx.rect(x * 30, y * 30, 30, 30);\n    ctx.stroke();\n    ctx.fillRect(x * 30, y * 30, 30, 30);\n    ctx.fillStyle = \"black\";\n    grid[y][x] = letter;\n    ctx.fillText(grid[y][x], x * 30 + 30 / 2, y * 30 + 30 / 2);\n  }\n  // draws cell vertically on the canvas\n  function putCellVertically(x, y, ctx) {\n    ctx.fillStyle = \"white\";\n    ctx.beginPath();\n    ctx.rect(x * 30, y * 30, 30, 30);\n    ctx.stroke();\n    ctx.fillRect(x * 30, y * 30, 30, 30);\n    ctx.fillStyle = \"black\";\n  }\n  // draws word serial number vertically on the canvas\n  function putNumberVertically(x, y, number, ctx) {\n    var cxy = [x, y];\n    cellYX.push(cxy);\n    downNums.push(number);\n    ctx.fillStyle = \"black\";\n    ctx.fillText(number, x * 30 + 20, y * 30 + 20);\n  }\n  // draws letter horizontally on the canvas\n  function putLetterAtHorizontally(x, y, letter, ctx) {\n    ctx.fillStyle = \"white\";\n    ctx.beginPath();\n    ctx.rect(x * 30, y * 30, 30, 30);\n    ctx.stroke();\n    ctx.fillRect(x * 30, y * 30, 30, 30);\n    ctx.fillStyle = \"black\";\n    grid[y][x] = letter;\n    ctx.fillText(grid[y][x], x * 30 + 30 / 2, y * 30 + 30 / 2);\n  }\n  // draws cell horizontally on the canvas\n  function putCellHorizontally(x, y, ctx) {\n    ctx.fillStyle = \"white\";\n    ctx.beginPath();\n    ctx.rect(x * 30, y * 30, 30, 30);\n    ctx.stroke();\n    ctx.fillRect(x * 30, y * 30, 30, 30);\n    ctx.fillStyle = \"black\";\n  }\n  // draws word serial number horizontally on the canvas\n  function putNumberHorizontally(x, y, number, ctx) {\n    var cxy = [x, y];\n    cellXY.push(cxy);\n    acrossNums.push(number);\n    ctx.fillStyle = \"black\";\n    ctx.fillText(number, x * 30 + 10, y * 30 + 10);\n  }\n  // is the horizontal word's right cell empty?\n  function isCleanHeadAcross(x, y, word) {\n    var len = word.length;\n    var head = x + len;\n    if (head >= grid_size) return true;\n    return isEmpty(head, y);\n  }\n  // is the vertical word's bottom cell empty?\n  function isCleanHeadDown(x, y, word) {\n    var len = word.length;\n    var head = y + len;\n    if (head >= grid_size) return true;\n    return isEmpty(x, head);\n  }\n  // is the horizontal word's left cell empty?\n  function isCleanTailAcross(x, y) {\n    if (x === grid_start) return true;\n    return isEmpty(x - 1, y);\n  }\n  // is the vertical word's top cell empty?\n  function isCleanTailDown(x, y) {\n    if (y === grid_start) return true;\n    return isEmpty(x, y - 1);\n  }\n  // is the word to be placed across overlapping another word?\n  function isOverlappingAcross(x, y, word) {\n    var len = word.length;\n    var grid_word = \"\";\n    for (var j = 0; j < len; j++) {\n      grid_word += letterAt(x + j, y);\n    }\n    return wordPlaced.includes(grid_word);\n  }\n  // is the word to be placed down overlapping another word?\n  function isOverlappingDown(x, y, word) {\n    var len = word.length;\n    var grid_word = \"\";\n    for (var j = 0; j < len; j++) {\n      if (y + j >= grid_size) continue;\n      if (y + j <= grid_start) continue;\n      grid_word += letterAt(x, y + j);\n    }\n    return wordPlaced.includes(grid_word);\n  }\n  // check if the word to be placed across is touching another word's head\n  function touchTopAcross(x, y, word) {\n    if (y < 1) return false;\n    var len = word.length;\n    for (var j = 0; j < len; j++) {\n      var u = y - 1;\n      var grid_word = \"\";\n      while (isLetter(x + j, u)) {\n        grid_word += letterAt(x + j, u);\n        u--;\n        if (u === -1) break;\n      }\n      var reverse = reverseString(grid_word);\n      if (wordPlaced.includes(reverse)) return true;\n    }\n    return false;\n  }\n  // check if the word to be placed across is touching another word's tail\n  function touchBottomAcross(x, y, word) {\n    if (y === grid_end) return false;\n    var len = word.length;\n    for (var j = 0; j < len; j++) {\n      var u = y + 1;\n      var grid_word = \"\";\n      while (isLetter(x + j, u)) {\n        grid_word += letterAt(x + j, u);\n        u++;\n        if (u === grid_size) break;\n      }\n      if (wordPlaced.includes(grid_word)) return true;\n    }\n    return false;\n  }\n  // check if the word to be placed down is touching another word's head\n  function touchleftDown(x, y, word) {\n    if (x === 0) return false;\n    var len = word.length;\n    for (var j = 0; j < len; j++) {\n      var u = x - 1;\n      var grid_word = \"\";\n      if (y + j >= grid_size) continue;\n      if (y + j <= grid_start) continue;\n      while (isLetter(u, y + j)) {\n        grid_word += letterAt(u, y + j);\n        u--;\n        if (u === -1) break;\n      }\n      var reverse = reverseString(grid_word);\n      if (wordPlaced.includes(reverse)) return true;\n    }\n    return false;\n  }\n  // check if the word to be placed down is touching another word's tail\n  function touchRightDown(x, y, word) {\n    if (x === grid_end) return false;\n    var len = word.length;\n    for (var j = 0; j < len; j++) {\n      var u = x + 1;\n      var grid_word = \"\";\n      if (y + j >= grid_size) continue;\n      if (y + j <= grid_start) continue;\n      while (isLetter(u, y + j)) {\n        grid_word += letterAt(u, y + j);\n        u++;\n        if (u === grid_size) break;\n      }\n      if (wordPlaced.includes(grid_word)) return true;\n    }\n    return false;\n  }\n  // check if the word to be placed across is fully lonely\n  function isValidIsolateAcross(x, y, word) {\n    var len = word.length;\n    var answer = true;\n    for (var j = 0; j < len; j++) {\n      answer = isEmpty(x + j, y);\n      if (!answer) break;\n    }\n    return answer;\n  }\n  // check if the word to be placed down is fully lonely\n  function isValidIsolateDown(x, y, word) {\n    var len = word.length;\n    var answer = true;\n    for (var j = 0; j < len; j++) {\n      answer = isEmpty(x, y + j);\n      if (!answer) break;\n    }\n    return answer;\n  }\n  // check if the word to be placed across is crossing another word legitimately\n  function isValidCrossAcross(x, y, word) {\n    var len = word.length;\n    var c = 0;\n    for (var j = 0; j < len; j++) {\n      if (letterAt(x + j, y) === word[j] || letterAt(x + j, y) === \"_\") c++;\n    }\n    if (len === c) return true;\n    else return false;\n  }\n  // check if the word to be placed down is crossing another word legitimately\n  function isValidCrossDown(x, y, word) {\n    var len = word.length;\n    var c = 0;\n    for (var j = 0; j < len; j++) {\n      if (y + j >= grid_size) break;\n      if (y + j <= grid_start) break;\n      if (letterAt(x, y + j) === word[j] || letterAt(x, y + j) === \"_\") c++;\n    }\n    if (len === c) return true;\n    else return false;\n  }\n  // place a word on the canvas spreading horizontally\n  function placeWordAcross(x, y, word, index, ctx, ctx2) {\n    var len = word.length;\n    for (var j = 0; j < len; j++) {\n      putCellHorizontally(x + j, y, ctx2);\n      putLetterAtHorizontally(x + j, y, word[j], ctx);\n    }\n    wordPlaced.push(word);\n    var i = wordsOriginal.indexOf(word);\n    putNumberHorizontally(x, y, i, ctx2);\n    document.getElementById(\"across\").innerHTML +=\n      i + \". \" + hints[i] + \"<br/>\";\n  }\n  // place a word on the canvas spreading vertically\n  function placeWordDown(x, y, word, index, ctx, ctx2) {\n    var len = word.length;\n    for (var j = 0; j < len; j++) {\n      putCellVertically(x, y + j, ctx2);\n      putLetterAtVertically(x, y + j, word[j], ctx);\n    }\n    wordPlaced.push(word);\n    downCount++;\n    var i = wordsOriginal.indexOf(word);\n    putNumberVertically(x, y, i, ctx2);\n    document.getElementById(\"down\").innerHTML += i + \". \" + hints[i] + \"<br/>\";\n  }\n  // checks if a word can be placed crossing another word on the canvas\n  function canPlaceOnGridCross(word, index, direction, ctx, ctx2) {\n    if (direction === \"down\") return canPlaceCrossDown(word, index, ctx, ctx2);\n    if (direction === \"across\")\n      return canPlaceCrossAcross(word, index, ctx, ctx2);\n  }\n  // checks if a word can be placed at a lonely place on the canvas\n  function canPlaceOnGridIsolate(x, y, word, index, direction, ctx, ctx2) {\n    if (direction === \"down\")\n      return canPlaceIsolateDown(x, y, word, index, ctx, ctx2);\n    if (direction === \"across\")\n      return canPlaceIsolateAcross(x, y, word, index, ctx, ctx2);\n  }\n  // checks if a word can be placed horizontally crossing another word\n  function canPlaceCrossAcross(word, index, ctx, ctx2) {\n    var placed = false;\n    for (var i = 0; i < word.length; i++) {\n      var result = matchVerPoints(word[i]);\n      if (result.length > 0 && !placed) {\n        for (var j = 0; j < result.length; j++) {\n          var xp = result[j].x - i;\n          var yp = result[j].y;\n          if (isValidCrossAcross(xp, yp, word))\n            if (isCleanHeadAcross(xp, yp, word))\n              if (isCleanTailAcross(xp, yp))\n                if (!touchTopAcross(xp, yp, word))\n                  if (!touchBottomAcross(xp, yp, word)) {\n                    //if (isValidCrossAcross(xp, yp, word))\n                    // if (!isOverlappingAcross(xp, yp, word))\n                    placeWordAcross(xp, yp, word, index, ctx, ctx2);\n                    addHorPoints(xp, yp, word.length);\n                    placed = true;\n                    break;\n                  }\n        }\n      }\n      if (placed) break;\n    }\n    return placed;\n  }\n  // checks if a word can be placed vertically crossing another word\n  function canPlaceCrossDown(word, index, ctx, ctx2) {\n    var placed = false;\n    for (var i = 0; i < word.length; i++) {\n      var result = matchHorPoints(word[i]);\n      if (result.length > 0 && !placed) {\n        for (var j = 0; j < result.length; j++) {\n          var xp = result[j].x;\n          var yp = result[j].y - i;\n          if (isValidCrossDown(xp, yp, word))\n            if (isCleanHeadDown(xp, yp, word))\n              if (isCleanTailDown(xp, yp))\n                if (!touchleftDown(xp, yp, word))\n                  if (!touchRightDown(xp, yp, word)) {\n                    //if (isValidCrossDown(xp, yp, word))\n                    // if (!isOverlappingDown(xp, yp, word))\n                    placeWordDown(xp, yp, word, index, ctx, ctx2);\n                    addVerPoints(xp, yp, word.length);\n                    placed = true;\n                    break;\n                  }\n        }\n      }\n      if (placed) break;\n    }\n    return placed;\n  }\n  // checks if a word can be placed horizontally at a lonely place\n  function canPlaceIsolateAcross(x, y, word, index, ctx, ctx2) {\n    if (isCleanHeadAcross(x, y, word)) {\n      if (isCleanTailAcross(x, y)) {\n        if (!isOverlappingAcross(x, y, word)) {\n          if (!touchTopAcross(x, y, word)) {\n            if (!touchBottomAcross(x, y, word)) {\n              if (isValidIsolateAcross(x, y, word)) {\n                placeWordAcross(x, y, word, index, ctx, ctx2);\n                addHorPoints(x, y, word.length);\n                return true;\n              }\n            }\n          }\n        }\n      }\n    }\n    return false;\n  }\n  // checks if a word can be placed vertically at a lonely place\n  function canPlaceIsolateDown(x, y, word, index, ctx, ctx2) {\n    if (isCleanHeadDown(x, y, word))\n      if (isCleanTailDown(x, y))\n        if (!isOverlappingDown(x, y, word))\n          if (!touchleftDown(x, y, word))\n            if (!touchRightDown(x, y, word))\n              if (isValidIsolateDown(x, y, word)) {\n                placeWordDown(x, y, word, index, ctx, ctx2);\n                addVerPoints(x, y, word.length);\n                return true;\n              }\n    return false;\n  }\n  // stores all the letter positions a horizontal word occupies\n  function addHorPoints(x, y, len) {\n    var point = { x: 0, y: 0 };\n    for (var i = 0; i < len; i++) {\n      point.x = x + i;\n      point.y = y;\n      horizontalPoints.push({ x: point.x, y: point.y });\n    }\n  }\n  // stores all the letter positions a vertical word occupies\n  function addVerPoints(x, y, len) {\n    var point = { x: 0, y: 0 };\n    for (var i = 0; i < len; i++) {\n      point.x = x;\n      point.y = y + i;\n      verticalPoints.push({ x: point.x, y: point.y });\n    }\n  }\n  // check if a letter of a horizontal word matches with any letter of the words placed so far\n  function matchHorPoints(letter) {\n    var matchingPoints = [];\n    var point = { x: 0, y: 0 };\n    for (var i = 0; i < horizontalPoints.length; i++) {\n      point.x = horizontalPoints[i].x;\n      point.y = horizontalPoints[i].y;\n      if (letterAt(point.x, point.y) === letter)\n        matchingPoints.push({ x: point.x, y: point.y });\n    }\n    return matchingPoints;\n  }\n  // check if a letter of a vertical word matches with any letter of the words placed so far\n  function matchVerPoints(letter) {\n    var matchingPoints = [];\n    var point = { x: 0, y: 0 };\n    for (var i = 0; i < verticalPoints.length; i++) {\n      point.x = verticalPoints[i].x;\n      point.y = verticalPoints[i].y;\n      if (letterAt(point.x, point.y) === letter)\n        matchingPoints.push({ x: point.x, y: point.y });\n    }\n    return matchingPoints;\n  }\n\n  // initialize variable with sample cross words.\n  function fillCrossData() {\n    var data = \"Heller, Catch-22 (1961)\\n\";\n    data += \"Fitzgerald, The Great Gatsby\\n\";\n    data += \"Williams, The Glass Menagerie\\n\";\n    data += \"Buck, The Good Earth (1931)\\n\";\n    data += \"London, The Call of the Wild\\n\";\n    data += \"Miller, Death of a Salesman\\n\";\n    data += \"Hemingway, A Farewell to Arms\\n\";\n    data += \"Orwell, 1984\\n\";\n    data += \"Kesey, One Flew Over the Cuckoo's Nest\\n\";\n    data += \"Steinbeck, The Grapes of Wrath(1939)\";\n    setCrossWords(data);\n  }\n\n  // checks necessary requirements before signaling that the\n  // cross word puzzle can be generated.\n  function processCrossWords() {\n    var area = document.getElementById(\"cross-words\");\n    var lines = area.value.replace(/\\r\\n/g, \"\\n\").split(\"\\n\");\n    words = [];\n    hints = [];\n    if (lines.length < 10) {\n      alert(\"Give at least 10 words\");\n      return false;\n    }\n    for (var i = 0; i < lines.length; i++) {\n      var word_hint = lines[i].split(\",\");\n      words.push(word_hint[0].toUpperCase());\n      hints.push(word_hint[1]);\n    }\n    wordsOriginal = [...words];\n    return true;\n  }\n\n  // cross word puzzle generator function\n  function makeCrossWords() {\n    // initializes the two canvases - puzzle and answer\n    var btnPuzzle = document.getElementById(\"btnReload\");\n    btnPuzzle.innerHTML = \"RELOAD PUZZLE\";\n    var btnAnswer = document.getElementById(\"btnAnswer\");\n    btnAnswer.innerHTML = \"SHOW ANSWER\";\n    var canvas = document.getElementById(\"answer-canvas\");\n    var ctx = canvas.getContext(\"2d\");\n    var canvas2 = document.getElementById(\"puzzle-canvas\");\n    var ctx2 = canvas2.getContext(\"2d\");\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx2.clearRect(0, 0, canvas2.width, canvas2.height);\n    ctx.font = \"14px verdana\";\n    ctx.textAlign = \"center\";\n    ctx.textBaseline = \"middle\";\n    ctx.fillStyle = \"black\";\n    ctx2.font = \"14px verdana\";\n    ctx2.textAlign = \"center\";\n    ctx2.textBaseline = \"middle\";\n    ctx2.fillStyle = \"black\";\n    var isolateCount = words.length;\n    // zero outing the variables\n    wordPlaced = [];\n    downCount = 0;\n    acrossNums = [];\n    downNums = [];\n    cellXY = [];\n    cellYX = [];\n    // initialize the puzzle grid with \"_\". \"_\" means nothing or empty\n    for (var r = 0; r < grid_size; r++) {\n      grid[r] = [];\n      for (var c = 0; c < grid_size; c++) {\n        grid[r][c] = \"_\";\n      }\n    }\n\n    document.getElementById(\"across\").innerHTML = \"\";\n    document.getElementById(\"down\").innerHTML = \"\";\n    ctx2.fillText(crossTitle, 100, 20);\n    ctx.fillText(crossTitle, 100, 20);\n\n    // sort the words from biggest to smallest\n    words.sort(function (a, b) {\n      // ASC  -> a.length - b.length\n      // DESC -> b.length - a.length\n      return b.length - a.length;\n    });\n\n    // this loop places all the cross words on the canvas\n    // runs a while loop 100 times for every single word to place the word across or down the grid\n    // but place the first word in a random direction starting from cell 3,3\n    for (var i = 0; i < isolateCount; i++) {\n      var word = words[i];\n      var counter = 100;\n      while (counter > 0) {\n        var currentDirection =\n          direction[Math.floor(Math.random() * direction.length)];\n        if (i < 1) break;\n        if (canPlaceOnGridCross(word, i, currentDirection, ctx, ctx2)) {\n          break;\n        }\n        counter--;\n      }\n\n      if (i < 1) {\n        canPlaceOnGridIsolate(3, 3, word, i, currentDirection, ctx, ctx2);\n      }\n    }\n    // number the starting cell of each word accordingly\n    ctx.fillStyle = \"black\";\n    for (i = 0; i < cellXY.length; i++) {\n      ctx2.fillText(\n        acrossNums[i],\n        cellXY[i][0] * 30 + 10,\n        cellXY[i][1] * 30 + 10\n      );\n    }\n    for (i = 0; i < cellYX.length; i++) {\n      ctx2.fillText(\n        downNums[i],\n        cellYX[i][0] * 30 + 20,\n        cellYX[i][1] * 30 + 20\n      );\n    }\n  }\n\n  // show cross word puzzle answer\n  // answers are already drawn in hidden answer canvas\n  // the canvas is shown when user clicks the\n  // show answer button\n  function showCrossAnswer() {\n    var answerCanvas = document.getElementById(\"answer-canvas\");\n    var puzzleCanvas = document.getElementById(\"puzzle-canvas\");\n    var btnAnswer = document.getElementById(\"btnAnswer\");\n    if (\n      answerCanvas.style.visibility === \"\" ||\n      answerCanvas.style.visibility === \"hidden\"\n    ) {\n      answerCanvas.style.visibility = \"visible\";\n      puzzleCanvas.style.visibility = \"hidden\";\n      btnAnswer.innerHTML = \"HIDE ANSWER\";\n    } else {\n      answerCanvas.style.visibility = \"hidden\";\n      puzzleCanvas.style.visibility = \"visible\";\n      btnAnswer.innerHTML = \"SHOW ANSWER\";\n    }\n  }\n\n  /******************* Double Puzzle Code Starts Here **************/\n  /*\n  Functions for this puzzle\n  1. fillDoubleData()\n  2. fillFinalWord()\n  3. processDoubleWords()\n  4. makeDoublePuzzle()\n  5. showDoubleAnswer()\n  */\n  // fills storage variable with sample data\n  function fillDoubleData() {\n    var data = \"noun\\n\";\n    data += \"verb\\n\";\n    data += \"pronoun\\n\";\n    data += \"preposition\\n\";\n    data += \"adverb\\n\";\n    data += \"adjective\\n\";\n    data += \"phrase\\n\";\n    data += \"participle\";\n    setDoubleWords(data);\n  }\n  // fills storage variable with sample final phrase\n  function fillFinalWord() {\n    var data = \"Parts of Speech\";\n    setFinalWord(data.toUpperCase());\n  }\n  // ensures that the required number of words are given before okaying for\n  // generating the puzzle\n  function processDoubleWords() {\n    var area = document.getElementById(\"double-words\");\n    var lines = area.value.replace(/\\r\\n/g, \"\\n\").split(\"\\n\");\n    words = [];\n    hints = [];\n    if (lines.length < 5) {\n      alert(\"Give at least 5 words\");\n      return false;\n    }\n    for (var i = 0; i < lines.length; i++) {\n      words.push(lines[i].toUpperCase());\n    }\n    wordsOriginal = [...words];\n    return true;\n  }\n  // this function generates the double puzzle\n  function makeDoublePuzzle() {\n    //initializes the two canvas - puzzle and answer\n    var btnPuzzle = document.getElementById(\"btnReload\");\n    btnPuzzle.innerHTML = \"RELOAD PUZZLE\";\n    var btnAnswer = document.getElementById(\"btnAnswer\");\n    btnAnswer.innerHTML = \"SHOW ANSWER\";\n    var canvas = document.getElementById(\"puzzle-canvas\");\n    var ctx = canvas.getContext(\"2d\");\n    var canvas2 = document.getElementById(\"answer-canvas\");\n    var ctx2 = canvas2.getContext(\"2d\");\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx2.clearRect(0, 0, canvas2.width, canvas2.height);\n    ctx.font = \"16px verdana\";\n    ctx.textBaseline = \"middle\";\n    ctx.fillStyle = \"black\";\n    ctx2.font = \"16px verdana\";\n    ctx2.textBaseline = \"middle\";\n    ctx2.fillStyle = \"black\";\n    ctx.textAlign = \"left\";\n    ctx2.textAlign = \"left\";\n    var startX = 50;\n    var startY = 60;\n    //var startYRect = 80;\n    var finalY = 0;\n    var letterMatrix = [];\n    var singleSpaceString = finalWord.replace(/\\s+/g, \" \").trim();\n    var noSpaceString = singleSpaceString.split(\" \").join(\"\"); // remove any space from the final phrase\n    var uniqueLetterWords = removeDuplicateCharacters(noSpaceString); // remove any duplicate letters from the final phrase\n    var allWords = \"\";\n    var finalString = [];\n    var matchedString = [];\n    var groupLetter = [];\n    var smallLetterPos = [];\n    var l = 1;\n    var z = 0;\n    ctx.beginPath();\n    ctx2.beginPath();\n\n    if (doubleOption === 1) {\n      for (var n = 0; n < words.length; n++) {\n        // shuffle the letters of every word\n        var shuf = words[n].shuffle();\n        // draw the words one below one\n        ctx.fillText(shuf, startX, 20 + startY * n);\n        ctx2.fillText(shuf, startX, 20 + startY * n);\n        // draw cell around every letter of every word\n        for (var i = 0; i < words[n].length; i++) {\n          ctx.rect(i * 30 + startX, 30 + startY * n, 30, 30);\n          ctx2.rect(i * 30 + startX, 30 + startY * n, 30, 30);\n          // draw the answer - the original word supplied by the user\n          ctx2.fillText(\n            words[n][i],\n            i * 30 + startX + 10,\n            30 + 15 + startY * n\n          );\n          for (var j = 0; j < uniqueLetterWords.length; j++)\n            if (uniqueLetterWords[j] === words[n][i]) {\n              letterMatrix.push({ letter: uniqueLetterWords[j], n: n, i: i });\n            }\n        }\n        smallLetterPos.push(30 + 15 + startY * n);\n      }\n      ctx.stroke();\n      ctx2.stroke();\n      for (var p = 0; p < words.length; p++) {\n        allWords += words[p];\n      }\n      for (var q = 0; q < singleSpaceString.length; q++) {\n        if (allWords.includes(singleSpaceString[q])) {\n          finalString.push(\"_\");\n          matchedString.push(singleSpaceString[q]);\n        } else finalString.push(singleSpaceString[q]);\n      }\n\n      for (i = 0; i < singleSpaceString.length; i++) {\n        groupLetter = [];\n        for (var k = 0; k < letterMatrix.length; k++)\n          if (letterMatrix[k].letter === singleSpaceString[i]) {\n            groupLetter.push(k);\n          }\n        if (groupLetter.length > 0) {\n          ctx.beginPath();\n          ctx2.beginPath();\n          var randomPosition = Math.floor(Math.random() * groupLetter.length);\n          var idx = groupLetter[randomPosition];\n          var wordInWords = letterMatrix[idx].n;\n          var letterInWord = letterMatrix[idx].i;\n          ctx.arc(\n            letterInWord * 30 + startX + 15,\n            smallLetterPos[wordInWords],\n            15,\n            0,\n            2 * Math.PI\n          );\n          ctx2.arc(\n            letterInWord * 30 + startX + 15,\n            smallLetterPos[wordInWords],\n            15,\n            0,\n            2 * Math.PI\n          );\n          ctx.stroke();\n          ctx2.stroke();\n          // if (groupLetter.length > 1)\n          letterMatrix.splice(idx, 1);\n          l++;\n        } else {\n          finalString[i] = singleSpaceString[i];\n          console.log(singleSpaceString[i]);\n        }\n      }\n      finalY = 30 + 10 + startY * n;\n      ctx.beginPath();\n      ctx2.beginPath();\n      for (i = 0; i < singleSpaceString.length; i++) {\n        if (singleSpaceString[i] === \" \") continue;\n        ctx.rect(startX + i * 30, finalY, 30, 30);\n        ctx2.rect(startX + i * 30, finalY, 30, 30);\n        ctx2.fillText(singleSpaceString[i], startX + 10 + i * 30, finalY + 15);\n        if (finalString[i] !== \"_\") {\n          ctx.fillText(singleSpaceString[i], startX + 10 + i * 30, finalY + 15);\n          continue;\n        }\n        z++;\n      }\n      ctx.stroke();\n      ctx2.stroke();\n      return;\n    }\n    // loop to put shuffled words line by line\n    for (n = 0; n < words.length; n++) {\n      shuf = words[n].shuffle(); // shuffle the word first\n      ctx.fillText(shuf, startX, 20 + startY * n); // draw the word in both canvas\n      ctx2.fillText(shuf, startX, 20 + startY * n);\n      for (i = 0; i < words[n].length; i++) {\n        ctx.rect(i * 30 + startX, 30 + startY * n, 30, 30); // draw box around the word\n        ctx2.rect(i * 30 + startX, 30 + startY * n, 30, 30);\n        ctx2.fillText(words[n][i], i * 30 + startX + 10, 30 + 15 + startY * n); // draw the original word letter in answer canvas\n        for (j = 0; j < uniqueLetterWords.length; j++)\n          if (uniqueLetterWords[j] === words[n][i]) {\n            // uniqueLetterWords has the final phrase without any duplicate char\n            letterMatrix.push({ letter: uniqueLetterWords[j], n: n, i: i }); // if any letter of the word matches with final phrase save it and it's location\n          }\n      }\n      smallLetterPos.push(30 + 38 + startY * n); // save the Y position of the numbering letters as hint\n    }\n    // append all words in a single string\n    for (p = 0; p < words.length; p++) {\n      allWords += words[p];\n    }\n    // check if final phrase has any matching letter from the anagram words\n    for (q = 0; q < singleSpaceString.length; q++) {\n      if (allWords.includes(singleSpaceString[q])) {\n        finalString.push(\"_\"); // if it has, then that letter will be hidden in the puzzle, which will be solved by the user\n        matchedString.push(singleSpaceString[q]); // save that letter in matchedString variable for later use\n      } else finalString.push(singleSpaceString[q]); // else that letter will be printed in the puzzle, so add it in the final phrase string\n    }\n\n    // here we number the letters of the anagrams that occur in the final phrase\n    // If there are more thatn one letters for the corresponding letter in the final phrase\n    // we randomly number only one of them\n    ctx.font = \"12px verdana\";\n    ctx2.font = \"12px verdana\";\n    finalY = 30 + 10 + startY * n;\n    var wl = [];\n    var finalIndices = [];\n    for (i = 0; i < matchedString.length; i++) {\n      // mathedSting has all the letters that matched with the anagram words. Run a loop for every matched string and find how many times they match\n      groupLetter = [];\n      for (k = 0; k < letterMatrix.length; k++)\n        if (letterMatrix[k].letter === matchedString[i]) {\n          groupLetter.push(k);\n        }\n      if (groupLetter.length > 0) {\n        // group letter has the indices of the matched letters and their location in anagram words\n        randomPosition = Math.floor(Math.random() * groupLetter.length); // get a random index from thoses indices\n        idx = groupLetter[randomPosition];\n        wordInWords = letterMatrix[idx].n; // get the anagram word that has that matched index\n        letterInWord = letterMatrix[idx].i; // get the letter index in that word\n        var positionInWords = wordInWords * 100 + letterInWord; // every anagram word is 100 pixel apart\n        var matched = false; // now run a loop to find out if the letter is already numbered\n        for (var a = 0; a < wl.length; a++) {\n          if (positionInWords === wl[a]) {\n            matched = true;\n            break;\n          }\n        }\n        wl.push(positionInWords); // save the position in an array to check later if that position is already numbered\n        if (matched) {\n          finalIndices.push(a + 1); // if there is already a match, then just push the lowest index\n          continue;\n        } else {\n          // else print the index of the matching final phrase letter below the anagram letter, so that user can use it to solve the final phrase\n          ctx.fillText(\n            l,\n            letterInWord * 30 + startX + 10,\n            smallLetterPos[wordInWords]\n          );\n          ctx2.fillText(\n            l,\n            letterInWord * 30 + startX + 10,\n            smallLetterPos[wordInWords]\n          );\n          finalIndices.push(l); // save that index for later printing below the final phrase\n        }\n        if (groupLetter.length > 1) letterMatrix.splice(idx, 1); // already a match found, so reduce the number of groupLetter element by 1\n        l++;\n      }\n    }\n    // print the final phrase letter celss with numbering\n    for (i = 0; i < singleSpaceString.length; i++) {\n      if (singleSpaceString[i] === \" \") continue; // dont' print any cell for blank space\n      ctx.rect(startX + i * 30, finalY, 30, 30);\n      ctx2.rect(startX + i * 30, finalY, 30, 30);\n      ctx2.fillText(singleSpaceString[i], startX + 10 + i * 30, finalY + 15); // print the letters in the answer no matter what\n      if (finalString[i] !== \"_\") {\n        // only print the letter in the puzzle if no match found\n        ctx.fillText(singleSpaceString[i], startX + 10 + i * 30, finalY + 15);\n        continue; // dont print the hint number below the letter printed\n      }\n      ctx.fillText(finalIndices[z], startX + 10 + i * 30, finalY + 40); // print the number below the letter\n      ctx2.fillText(finalIndices[z], startX + 10 + i * 30, finalY + 40);\n      z++;\n    }\n    ctx.stroke();\n    ctx2.stroke();\n  }\n  // this shows the answer of the Double puzzle\n  function showDoubleAnswer() {\n    var answerCanvas = document.getElementById(\"answer-canvas\");\n    var puzzleCanvas = document.getElementById(\"puzzle-canvas\");\n    var btnAnswer = document.getElementById(\"btnAnswer\");\n    if (\n      answerCanvas.style.visibility === \"\" ||\n      answerCanvas.style.visibility === \"hidden\"\n    ) {\n      answerCanvas.style.visibility = \"visible\";\n      puzzleCanvas.style.visibility = \"hidden\";\n      btnAnswer.innerHTML = \"HIDE ANSWER\";\n    } else {\n      answerCanvas.style.visibility = \"hidden\";\n      puzzleCanvas.style.visibility = \"visible\";\n      btnAnswer.innerHTML = \"SHOW ANSWER\";\n    }\n  }\n  /***************Fallen Phrase Puzzle Code Starts Here   ******************/\n  /**\n   Functions to generate Fallen Phrase Puzzle\n   1. fillFallenData()\n   2. processFallenWords()\n   3. makeFallenPuzzle()\n   4. showFallenAnswer()\n   */\n  function fillFallenData() {\n    var data =\n      '\"Some are born great, some achieve greatness, and some have greatness thrust upon them.\"';\n    data += \" - William Shakespeare\";\n    setFallenWords(data);\n  }\n\n  var fallenArray = [];\n  var upperFallenPhrase = \"\";\n  // process user inputs and confirms if the puzzle can be made\n  function processFallenWords() {\n    var area = document.getElementById(\"fallen-words\");\n    var lines = area.value.replace(/\\s+/g, \" \").trim().split(\" \").join(\"\");\n    words = [];\n    if (lines.length < 40) {\n      alert(\"Give at least 40 letters phrase\");\n      return false;\n    }\n    fallenPhrase = area.value.replace(/\\s+/g, \" \").trim();\n    fallenArray = [];\n    while (fallenPhrase.length > 28) {\n      if (fallenPhrase[28] !== \" \") {\n        for (var i = 27; i > 0; i--) {\n          if (fallenPhrase[i] === \" \") break;\n        }\n        var letter28 = fallenPhrase.substring(0, i);\n        var extraEmptyChars = 28 - letter28.length;\n        var leftOver = extraEmptyChars % 2;\n        var padding = Math.floor(extraEmptyChars / 2);\n        var fineLine =\n          repeatStringNumTimes(\" \", padding) +\n          letter28 +\n          repeatStringNumTimes(\" \", padding) +\n          repeatStringNumTimes(\" \", leftOver);\n        fallenArray.push(fineLine);\n        fallenPhrase = fallenPhrase.substring(i + 1);\n      } else {\n        letter28 = fallenPhrase.substring(0, 28);\n        fallenArray.push(letter28);\n        fallenPhrase = fallenPhrase.substring(28);\n      }\n    }\n    extraEmptyChars = 28 - fallenPhrase.length;\n    leftOver = extraEmptyChars % 2;\n    padding = Math.floor(extraEmptyChars / 2);\n    fineLine =\n      repeatStringNumTimes(\" \", padding) +\n      fallenPhrase +\n      repeatStringNumTimes(\" \", padding) +\n      repeatStringNumTimes(\" \", leftOver);\n    fallenArray.push(fineLine);\n\n    fallenPhrase = \"\";\n    for (var j = 0; j < fallenArray.length; j++) {\n      fallenPhrase += fallenArray[j];\n    }\n    upperFallenPhrase = fallenPhrase.toUpperCase();\n    var count = 0;\n    fallenClueLetters = [];\n    while (count < fallenClueNo) {\n      var randomCharIndex = Math.floor(Math.random() * fallenPhrase.length);\n      if (isCharacterALetter(fallenPhrase[randomCharIndex])) {\n        var sameChar = false;\n        for (var p = 0; p < fallenClueLetters.length; p++) {\n          if (fallenClueLetters[p] === randomCharIndex) {\n            sameChar = true;\n            break;\n          }\n        }\n        if (sameChar) continue;\n        fallenClueLetters.push(randomCharIndex);\n        var newString =\n          upperFallenPhrase.slice(0, randomCharIndex) +\n          upperFallenPhrase.slice(\n            randomCharIndex + 1,\n            upperFallenPhrase.length\n          );\n        upperFallenPhrase = newString.slice(0);\n        count++;\n      }\n    }\n    const regex = /[!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~]/g;\n    var str = upperFallenPhrase.replace(regex, \"\");\n    strippedFallenPhrase = str.split(\" \").join(\"\").shuffle();\n    upperFallenPhrase = fallenPhrase.toUpperCase();\n    return true;\n  }\n  // function to generate fallen phrase puzzle\n  function makeFallenPuzzle() {\n    var btnPuzzle = document.getElementById(\"btnReload\");\n    btnPuzzle.innerHTML = \"RELOAD PUZZLE\";\n    var btnAnswer = document.getElementById(\"btnAnswer\");\n    btnAnswer.innerHTML = \"SHOW ANSWER\";\n    var canvas = document.getElementById(\"puzzle-canvas\");\n    var ctx = canvas.getContext(\"2d\");\n    var canvas2 = document.getElementById(\"answer-canvas\");\n    var ctx2 = canvas2.getContext(\"2d\");\n    // initializes the contexts and clear the canvas\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx2.clearRect(0, 0, canvas2.width, canvas2.height);\n    ctx.font = \"16px verdana\";\n    ctx.textBaseline = \"middle\";\n    ctx.fillStyle = \"black\";\n    ctx2.font = \"16px verdana\";\n    ctx2.textBaseline = \"middle\";\n    ctx2.fillStyle = \"black\";\n    ctx.textAlign = \"center\";\n    ctx2.textAlign = \"center\";\n    var startX = 10;\n    var startY = 50;\n    var cellWidth = 30;\n    var cellHeight = 30;\n    var iChars = \"~`!#$%^&*+=-[]\\\\';,/{}|\\\":<>?\";\n    ctx.beginPath();\n    ctx2.beginPath();\n    // initialize the grid\n    var fallenLetterGrid = [];\n    for (var r = 0; r < fallenArray.length; r++) {\n      fallenLetterGrid[r] = [];\n      for (var c = 0; c < 28; c++) {\n        fallenLetterGrid[r][c] = \"_\";\n      }\n    }\n    // fallenArray has the phrase already formatted for canvas printing\n    // any space will be printed as black box, any punctuation letter will be printed as it is\n    // otherwise, an empty box will be printed\n    // but on the answer canvas, the original phrase letters will be printed as well\n    // fallenLetterGrid will get a \"*\" for any blank or punctuation char\n    for (var n = 0; n < fallenArray.length; n++) {\n      for (var i = 0; i < fallenArray[n].length; i++) {\n        if (fallenArray[n][i] === \" \") {\n          fallenLetterGrid[n][i] = \"*\";\n          ctx.rect(\n            startX + i * cellWidth,\n            startY + n * 30,\n            cellWidth,\n            cellHeight\n          );\n          ctx.fillRect(\n            startX + i * cellWidth,\n            startY + n * 30,\n            cellWidth,\n            cellHeight\n          );\n          ctx2.rect(\n            startX + i * cellWidth,\n            startY + n * 30,\n            cellWidth,\n            cellHeight\n          );\n          ctx2.fillRect(\n            startX + i * cellWidth,\n            startY + n * 30,\n            cellWidth,\n            cellHeight\n          );\n        } else {\n          ctx.rect(\n            startX + i * cellWidth,\n            startY + n * 30,\n            cellWidth,\n            cellHeight\n          );\n          ctx2.rect(\n            startX + i * cellWidth,\n            startY + n * 30,\n            cellWidth,\n            cellHeight\n          );\n        }\n        if (iChars.indexOf(fallenArray[n].charAt(i)) !== -1) {\n          ctx.fillText(\n            fallenArray[n][i].toUpperCase(),\n            startX + i * cellWidth + 15,\n            startY + n * 30 + 15\n          );\n          fallenLetterGrid[n][i] = \"*\";\n        }\n        ctx2.fillText(\n          fallenArray[n][i].toUpperCase(),\n          startX + i * cellWidth + 15,\n          startY + n * 30 + 15\n        );\n        ctx.stroke();\n        ctx2.stroke();\n      }\n    }\n    // now print the clue letters given by the user. add a \"*\" for a clue letter\n    var startClueY = startY + n * 30 + 50;\n    for (i = 0; i < fallenClueLetters.length; i++) {\n      var idx = fallenClueLetters[i];\n      var row = Math.floor(idx / 28);\n      var col = idx % 28;\n      ctx.fillText(\n        upperFallenPhrase[idx],\n        startX + col * cellWidth + 15,\n        startY + row * 30 + 15\n      );\n      fallenLetterGrid[row][col] = \"*\";\n    }\n    // below are codes for formatting clue letters output\n    for (row = 0; row < fallenArray.length; row++) {\n      for (col = 0; col < 28; col++) {\n        if (\n          fallenLetterGrid[row][col] === \"_\" &&\n          strippedFallenPhrase[0] !== undefined\n        ) {\n          fallenLetterGrid[row][col] = strippedFallenPhrase[0];\n          var res = strippedFallenPhrase.slice(1);\n          strippedFallenPhrase = res;\n        }\n      }\n    }\n    for (row = fallenArray.length - 1; row > -1; row--) {\n      for (col = 0; col < 28; col++) {\n        if (fallenLetterGrid[row][col] === \"*\") {\n          for (n = row - 1; n > -1; n--) {\n            if (fallenLetterGrid[n][col] !== \"*\") {\n              fallenLetterGrid[row][col] = fallenLetterGrid[n][col];\n              fallenLetterGrid[n][col] = \"*\";\n              break;\n            }\n          }\n        }\n      }\n    }\n    for (row = 0; row < fallenArray.length; row++) {\n      for (col = 0; col < 28; col++) {\n        if (fallenLetterGrid[row][col] !== \"*\") {\n          ctx.fillText(\n            fallenLetterGrid[row][col],\n            startX + col * cellWidth + 15,\n            startClueY + row * cellWidth + 15\n          );\n          ctx2.fillText(\n            fallenLetterGrid[row][col],\n            startX + col * cellWidth + 15,\n            startClueY + row * cellWidth + 15\n          );\n        }\n      }\n    }\n  }\n  // function to show answer of Fallen Phrase puzzle\n  function showFallenAnswer() {\n    var answerCanvas = document.getElementById(\"answer-canvas\");\n    var puzzleCanvas = document.getElementById(\"puzzle-canvas\");\n    var btnAnswer = document.getElementById(\"btnAnswer\");\n    if (\n      answerCanvas.style.visibility === \"\" ||\n      answerCanvas.style.visibility === \"hidden\"\n    ) {\n      answerCanvas.style.visibility = \"visible\";\n      puzzleCanvas.style.visibility = \"hidden\";\n      btnAnswer.innerHTML = \"HIDE ANSWER\";\n    } else {\n      answerCanvas.style.visibility = \"hidden\";\n      puzzleCanvas.style.visibility = \"visible\";\n      btnAnswer.innerHTML = \"SHOW ANSWER\";\n    }\n  }\n  /*********************** Math Squares Puzzle Code Starts Here **********************\n   * Functions\n   * 1. processMathSquares()\n   * 2. makeMathPuzzle()\n   * 3. showMathAnswer()\n   */\n  // nothing to process, just returns true\n  function processMathSquares() {\n    return true;\n  }\n  var mathGrid = [];\n  var mathAnswerGrid = [];\n  var mathGridSize = 0;\n  // this function generates the math square puzzle\n  function makeMathPuzzle() {\n    // usual canvas setup\n    var btnPuzzle = document.getElementById(\"btnReload\");\n    btnPuzzle.innerHTML = \"RELOAD PUZZLE\";\n    var btnAnswer = document.getElementById(\"btnAnswer\");\n    btnAnswer.innerHTML = \"SHOW ANSWER\";\n    var canvas = document.getElementById(\"puzzle-canvas\");\n    var ctx = canvas.getContext(\"2d\");\n    var canvas2 = document.getElementById(\"answer-canvas\");\n    var ctx2 = canvas2.getContext(\"2d\");\n    // clear the canvas\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx2.clearRect(0, 0, canvas2.width, canvas2.height);\n    ctx.font = \"16px verdana\";\n    ctx.textBaseline = \"middle\";\n    ctx.fillStyle = \"black\";\n    ctx2.font = \"16px verdana\";\n    ctx2.textBaseline = \"middle\";\n    ctx2.fillStyle = \"black\";\n    ctx.textAlign = \"center\";\n    ctx2.textAlign = \"center\";\n    var startX = 10;\n    var startY = 50;\n\n    ctx.beginPath();\n    ctx2.beginPath();\n\n    mathGridSize = squireSize * 2 - 1;\n    // initialize the grids\n    for (var row = 0; row < mathGridSize; row++) {\n      mathGrid[row] = [];\n      mathAnswerGrid[row] = [];\n      for (var col = 0; col < mathGridSize; col++) {\n        mathGrid[row][col] = \"_\";\n        mathAnswerGrid[row][col] = \"_\";\n      }\n    }\n    var arr = [];\n    // the upperNumber is the square of the grid size\n    // that is if the math square is 3, then upper number is 9\n    // fill up the array with random number between 1 and the upper number\n    // a number is never repeated\n    while (arr.length < upperNumber) {\n      var r = Math.floor(Math.random() * upperNumber) + 1;\n      if (arr.indexOf(r) === -1) arr.push(r);\n    }\n    // operator signs\n    var mul = \"x\";\n    var divide = \"\\u00f7\";\n    var ops = [];\n    // to avoid division by a bigger number, addition or subtraction is used\n    var opsWithoutDiv = [\"+\", \"-\"];\n    if (opAddition) ops.push(\"+\");\n    if (opSubtraction) ops.push(\"-\");\n    if (opMultiiplication) ops.push(mul);\n    if (opDivision) ops.push(divide);\n    if (!opAddition && !opSubtraction && !opMultiiplication && !opDivision)\n      ops.push(\"+\"); // in case, no operation is selected, addition is used\n\n    var n = 0;\n    var c = 1;\n    var rightResult = []; // two results array\n    var bottomResult = [];\n    for (row = 0; row < mathGridSize; row = row + 2) {\n      // generate and  solve the row wise equations\n      var equation = []; // empty the equation array\n      for (col = 0; col < mathGridSize; col = col + 2) {\n        mathAnswerGrid[row][col] = arr[n]; // write the numbers in answer grid - numbers are in every odd numbered col\n        n++;\n      }\n      for (c = 1; c < mathGridSize; c = c + 2) {\n        var op = ops[Math.floor(Math.random() * ops.length)];\n        if (mathAnswerGrid[row][c - 1] < mathAnswerGrid[row][c + 1])\n          op = opsWithoutDiv[Math.floor(Math.random() * opsWithoutDiv.length)];\n        mathAnswerGrid[row][c] = op; // write the operator sign in the answer grid - operator signs are in every even numbered col\n      }\n      for (c = 0; c < mathGridSize; c++) {\n        equation.push(mathAnswerGrid[row][c]); // now make the complete equation by pushing every col\n      }\n      while (equation.length > 1) {\n        // solve the equation for every row now\n        for (var m = 0; m < equation.length; m++) {\n          if (equation[m] === mul || equation[m] === divide) {\n            // first find the multiplication or division because of their operator precedence\n            if (equation[m] === mul) {\n              var res = equation[m - 1] * equation[m + 1]; // the numbers are before and after the operator\n              equation[m + 1] = res; // over write the number that is after the operator with the multiplication\n              equation.splice(m - 1, 2); // now the number and the operator from the equation\n              break;\n            }\n            if (equation[m] === divide) {\n              // same formula for the division\n              res = Math.floor(equation[m - 1] / equation[m + 1]);\n              equation[m + 1] = res;\n              equation.splice(m - 1, 2);\n              break;\n            }\n          }\n        }\n        for (m = 0; m < equation.length; m++) {\n          // second find the addition or subtraction because of their operator precedence\n          if (equation[m] === \"+\" || equation[m] === \"-\") {\n            if (equation[m] === \"+\") {\n              //same formula like before\n              res = equation[m - 1] + equation[m + 1];\n              equation[m + 1] = res;\n              equation.splice(m - 1, 2);\n              break;\n            }\n            if (equation[m] === \"-\") {\n              res = equation[m - 1] - equation[m + 1];\n              equation[m + 1] = res;\n              equation.splice(m - 1, 2);\n              break;\n            }\n          }\n        }\n      }\n      rightResult.push(equation); // after splicing all the operators and numbers we now only have the result, lets save it\n    }\n    // lets store the operators that come between every two rows\n    for (row = 1; row < mathGridSize; row = row + 2) {\n      for (col = 0; col < mathGridSize; col = col + 2) {\n        op = ops[Math.floor(Math.random() * ops.length)];\n        if (mathAnswerGrid[row - 1][col] < mathAnswerGrid[row + 1][col])\n          op = opsWithoutDiv[Math.floor(Math.random() * opsWithoutDiv.length)];\n        mathAnswerGrid[row][col] = op;\n      }\n    }\n    // now make the equations for the columns the same way we did for the rows\n    for (col = 0; col < mathGridSize; col = col + 2) {\n      equation = [];\n      for (row = 0; row < mathGridSize; row++) {\n        equation.push(mathAnswerGrid[row][col]);\n      }\n      while (equation.length > 1) {\n        for (m = 0; m < equation.length; m++) {\n          if (equation[m] === mul || equation[m] === divide) {\n            if (equation[m] === mul) {\n              res = equation[m - 1] * equation[m + 1];\n              equation[m + 1] = res;\n              equation.splice(m - 1, 2);\n              break;\n            }\n            if (equation[m] === divide) {\n              res = Math.floor(equation[m - 1] / equation[m + 1]);\n              equation[m + 1] = res;\n              equation.splice(m - 1, 2);\n              break;\n            }\n          }\n        }\n        for (m = 0; m < equation.length; m++) {\n          if (equation[m] === \"+\" || equation[m] === \"-\") {\n            if (equation[m] === \"+\") {\n              res = equation[m - 1] + equation[m + 1];\n              equation[m + 1] = res;\n              equation.splice(m - 1, 2);\n              break;\n            }\n            if (equation[m] === \"-\") {\n              res = equation[m - 1] - equation[m + 1];\n              equation[m + 1] = res;\n              equation.splice(m - 1, 2);\n              break;\n            }\n          }\n        }\n      }\n      bottomResult.push(equation); // save the bottom results\n    }\n    // now lets print everything on the two canvas - puzzle and answer\n    var giveAwayNo = [];\n    while (giveAwayNo.length < mathClueNo) {\n      r = Math.floor(Math.random() * upperNumber) + 1;\n      if (giveAwayNo.indexOf(r) === -1) giveAwayNo.push(r);\n    }\n\n    ctx.beginPath();\n    for (row = 0; row < mathGridSize; row++) {\n      for (col = 0; col < mathGridSize; col++) {\n        ctx.rect(startX + 30 * col, startY + 30 * row, 30, 30);\n        ctx.stroke();\n        ctx2.rect(startX + 30 * col, startY + 30 * row, 30, 30);\n        if (\n          mathAnswerGrid[row][col] === \"+\" ||\n          mathAnswerGrid[row][col] === \"-\" ||\n          mathAnswerGrid[row][col] === mul ||\n          mathAnswerGrid[row][col] === divide\n        )\n          ctx.fillText(\n            mathAnswerGrid[row][col],\n            startX + 30 * col + 15,\n            startY + 30 * row + 15\n          );\n        ctx2.fillText(\n          mathAnswerGrid[row][col],\n          startX + 30 * col + 15,\n          startY + 30 * row + 15\n        );\n        ctx2.stroke();\n        if (mathAnswerGrid[row][col] === \"_\") {\n          ctx.fillRect(startX + 30 * col, startY + 30 * row, 30, 30);\n          ctx2.fillRect(startX + 30 * col, startY + 30 * row, 30, 30);\n        }\n      }\n      ctx.stroke();\n      ctx2.stroke();\n    }\n    for (var rc = 0; rc < giveAwayNo.length; rc++) {\n      for (row = 0; row < mathGridSize; row++) {\n        for (col = 0; col < mathGridSize; col++) {\n          if (mathAnswerGrid[row][col] === giveAwayNo[rc])\n            ctx.fillText(\n              mathAnswerGrid[row][col],\n              startX + 30 * col + 15,\n              startY + 30 * row + 15\n            );\n        }\n      }\n    }\n    if (Math.max(...rightResult) > 999) {\n      ctx.font = \"10px verdana\";\n      ctx2.font = \"10px verdana\";\n    }\n    if (Math.max(...bottomResult) > 999) {\n      ctx.font = \"10px verdana\";\n      ctx2.font = \"10px verdana\";\n    }\n    var answerX = startX + 30 * col;\n    var answerY = startY + 30 * row;\n\n    for (row = 0, rc = 0; row < mathGridSize; row = row + 2, rc++) {\n      ctx.rect(answerX + 10, startY + 30 * row, 40, 30);\n      ctx.fillText(rightResult[rc], answerX + 10 + 20, startY + 30 * row + 15);\n      ctx.stroke();\n      ctx2.rect(answerX + 10, startY + 30 * row, 40, 30);\n      ctx2.fillText(rightResult[rc], answerX + 10 + 20, startY + 30 * row + 15);\n      ctx2.stroke();\n    }\n\n    for (col = 0, rc = 0; col < mathGridSize; col = col + 2, rc++) {\n      ctx.rect(startX + 30 * col, answerY + 10, 40, 30);\n      ctx.fillText(bottomResult[rc], startX + 30 * col + 20, answerY + 10 + 15);\n      ctx.stroke();\n      ctx2.rect(startX + 30 * col, answerY + 10, 40, 30);\n      ctx2.fillText(\n        bottomResult[rc],\n        startX + 30 * col + 20,\n        answerY + 10 + 15\n      );\n      ctx2.stroke();\n    }\n  }\n\n  // function to show math square puzzle answer\n  function showMathAnswer() {\n    var answerCanvas = document.getElementById(\"answer-canvas\");\n    var puzzleCanvas = document.getElementById(\"puzzle-canvas\");\n    var btnAnswer = document.getElementById(\"btnAnswer\");\n    if (\n      answerCanvas.style.visibility === \"\" ||\n      answerCanvas.style.visibility === \"hidden\"\n    ) {\n      answerCanvas.style.visibility = \"visible\";\n      puzzleCanvas.style.visibility = \"hidden\";\n      btnAnswer.innerHTML = \"HIDE ANSWER\";\n    } else {\n      answerCanvas.style.visibility = \"hidden\";\n      puzzleCanvas.style.visibility = \"visible\";\n      btnAnswer.innerHTML = \"SHOW ANSWER\";\n    }\n  }\n  /******************* Letter Tiles Puzzle Starts Here **********************\n   * functions\n   * 1. fillLetterData()\n   * 2. processLetterTiles()\n   * 3. makeLetterPuzzle()\n   */\n  // this function fills variable with sample phrase\n  function fillLetterData() {\n    var data =\n      \"Imagination is more important than knowledge. Knowledge is limited. Imagination encircles the world.\";\n    setLetterPhrase(data);\n  }\n  // checks if user has given at least one sentence required to make the puzzle\n  // then processes it\n  function processLetterTiles() {\n    var lines = letterPhrase.replace(/\\s+/g, \" \").trim(); //.split(\" \").join(\"\");\n    if (lines.length < 6) {\n      alert(\"Put a sentence at least!\");\n      return false;\n    }\n    setLetterPhrase(lines); // removes extra white spaces\n    var scrambledPhrase = lines.shuffle(); // scramble the whole phrase\n    letterGroup = [];\n    scrambledLetterGroup = [];\n    // in this loop we divide the whole paragraph by number of letters selected by the user.\n    // save each group letterGroup array\n    while (lines.length > 0) {\n      var str = \"\";\n      for (var j = 0; j < numberOfLetter; j++) {\n        if (lines[j] === undefined) break;\n        str += lines[j];\n      }\n      if (str !== \"\") letterGroup.push(str);\n      lines = lines.slice(str.length);\n    }\n    // here we do the same thing but with the scrambled paragraph.\n    // the groups are saved in scrambledLetterGroup array\n    while (scrambledPhrase.length > 0) {\n      str = \"\";\n      for (j = 0; j < numberOfLetter; j++) {\n        if (scrambledPhrase[j] === undefined) break;\n        str += scrambledPhrase[j];\n      }\n      if (str !== \"\") scrambledLetterGroup.push(str);\n      scrambledPhrase = scrambledPhrase.slice(str.length);\n    }\n    return true;\n  }\n  // this function generates the letter tiles puzzle\n  function makeLetterPuzzle() {\n    // usual canvas initialize stuff\n    var btnPuzzle = document.getElementById(\"btnReload\");\n    btnPuzzle.innerHTML = \"RELOAD PUZZLE\";\n    var btnAnswer = document.getElementById(\"btnAnswer\");\n    btnAnswer.innerHTML = \"SHOW ANSWER\";\n    var canvas = document.getElementById(\"puzzle-canvas\");\n    var ctx = canvas.getContext(\"2d\");\n    var canvas2 = document.getElementById(\"answer-canvas\");\n    var ctx2 = canvas2.getContext(\"2d\");\n    // clear the canvas\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx2.clearRect(0, 0, canvas2.width, canvas2.height);\n    ctx.font = \"16px verdana\";\n    ctx.textBaseline = \"middle\";\n    ctx.fillStyle = \"black\";\n    ctx2.font = \"16px verdana\";\n    ctx2.textBaseline = \"middle\";\n    ctx2.fillStyle = \"black\";\n    ctx.textAlign = \"center\";\n    ctx2.textAlign = \"center\";\n    var startX = 1;\n    var startY = 50;\n    ctx.beginPath();\n    ctx2.beginPath();\n    var numberOfCellsInARow = 10;\n    var numberOfRow = Math.floor(\n      scrambledLetterGroup.length / numberOfCellsInARow\n    );\n    var lastRowColumn = scrambledLetterGroup.length % numberOfCellsInARow;\n    var letterWidth = 10;\n    var cellWidth =\n      (numberOfLetter + numberOfLetter - 1) * letterWidth + letterWidth * 2;\n    var cellHeight = 30;\n    var n = 0;\n    var answerStartY = numberOfRow * cellHeight + 100;\n    if (lastRowColumn > 0) answerStartY += cellHeight;\n    // this loop draws the puzzle on the canvas\n    for (var i = 0; i < numberOfRow; i++) {\n      for (var j = 0; j < numberOfCellsInARow; j++) {\n        // first draw the cells\n        ctx.rect(\n          startX + cellWidth * j + 5,\n          startY + cellHeight * i + 5,\n          cellWidth,\n          cellHeight\n        );\n        ctx2.rect(\n          startX + cellWidth * j + 5,\n          startY + cellHeight * i + 5,\n          cellWidth,\n          cellHeight\n        );\n        // then draw the scrambled phrases inside the cells\n        var cText = scrambledLetterGroup[n].split(\"\").join(\"  \");\n        ctx.fillText(\n          cText,\n          startX + cellWidth * j + numberOfLetter * 10 + 10,\n          startY + cellHeight * i + 20\n        );\n        ctx2.fillText(\n          cText,\n          startX + cellWidth * j + numberOfLetter * 10 + 10,\n          startY + cellHeight * i + 20\n        );\n        ctx.stroke();\n        ctx2.stroke();\n        // if show the answer area checkbox is not selected\n        // then clear the answer canvas and print the answer in the same celss when answer\n        // button is clicked\n        if (!showLetterAnswerArea) {\n          ctx2.clearRect(\n            startX + cellWidth * j + 5,\n            startY + cellHeight * i + 5,\n            cellWidth,\n            cellHeight\n          );\n          var originalText = letterGroup[n].split(\"\").join(\"  \");\n          ctx2.fillText(\n            originalText,\n            startX + cellWidth * j + numberOfLetter * 10 + 10,\n            startY + cellHeight * i + 20\n          );\n          ctx2.stroke();\n        }\n        n++;\n      }\n    }\n    // this loop draws the last row of the puzzle\n    for (j = 0; j < lastRowColumn; j++) {\n      ctx.rect(\n        startX + cellWidth * j + 5,\n        startY + cellHeight * i + 5,\n        cellWidth,\n        cellHeight\n      );\n      ctx2.rect(\n        startX + cellWidth * j + 5,\n        startY + cellHeight * i + 5,\n        cellWidth,\n        cellHeight\n      );\n      cText = scrambledLetterGroup[n].split(\"\").join(\"  \");\n      ctx.fillText(\n        cText,\n        startX + cellWidth * j + numberOfLetter * 10 + 10,\n        startY + cellHeight * i + 20\n      );\n      ctx2.fillText(\n        cText,\n        startX + cellWidth * j + numberOfLetter * 10 + 10,\n        startY + cellHeight * i + 20\n      );\n      ctx.stroke();\n      ctx2.stroke();\n      if (!showLetterAnswerArea) {\n        ctx2.clearRect(\n          startX + cellWidth * j + 5,\n          startY + cellHeight * i + 5,\n          cellWidth,\n          cellHeight\n        );\n        originalText = letterGroup[n].split(\"\").join(\"  \");\n\n        ctx2.fillText(\n          originalText,\n          startX + cellWidth * j + numberOfLetter * 10 + 10,\n          startY + cellHeight * i + 20\n        );\n        ctx2.stroke();\n      }\n      n++;\n    }\n    // if show the answer area is selected then a seperate grid is drawn with the answer\n    // below the puzzle\n    if (showLetterAnswerArea) {\n      n = 0;\n      for (i = 0; i < numberOfRow; i++) {\n        for (j = 0; j < numberOfCellsInARow; j++) {\n          originalText = letterGroup[n].split(\"\").join(\"  \");\n          ctx.rect(\n            startX + cellWidth * j + 5,\n            answerStartY + cellHeight * i + 5,\n            cellWidth,\n            cellHeight\n          );\n          ctx.stroke();\n          ctx2.rect(\n            startX + cellWidth * j + 5,\n            answerStartY + cellHeight * i + 5,\n            cellWidth,\n            cellHeight\n          );\n          ctx2.fillText(\n            originalText,\n            startX + cellWidth * j + numberOfLetter * 10 + 10,\n            answerStartY + cellHeight * i + 20\n          );\n          ctx2.stroke();\n          n++;\n        }\n      }\n      // this draws the last row of the grid\n      for (j = 0; j < lastRowColumn; j++) {\n        ctx.rect(\n          startX + cellWidth * j + 5,\n          answerStartY + cellHeight * i + 5,\n          cellWidth,\n          cellHeight\n        );\n        ctx2.rect(\n          startX + cellWidth * j + 5,\n          answerStartY + cellHeight * i + 5,\n          cellWidth,\n          cellHeight\n        );\n        ctx.stroke();\n        ctx2.stroke();\n        originalText = letterGroup[n].split(\"\").join(\"  \");\n        ctx2.fillText(\n          originalText,\n          startX + cellWidth * j + numberOfLetter * 10 + 10,\n          answerStartY + cellHeight * i + 20\n        );\n        n++;\n      }\n    }\n  }\n  // this function shows the answer of the puzzle\n  function showLetterAnswer() {\n    var answerCanvas = document.getElementById(\"answer-canvas\");\n    var puzzleCanvas = document.getElementById(\"puzzle-canvas\");\n    var btnAnswer = document.getElementById(\"btnAnswer\");\n    if (\n      answerCanvas.style.visibility === \"\" ||\n      answerCanvas.style.visibility === \"hidden\"\n    ) {\n      answerCanvas.style.visibility = \"visible\";\n      puzzleCanvas.style.visibility = \"hidden\";\n      btnAnswer.innerHTML = \"HIDE ANSWER\";\n    } else {\n      answerCanvas.style.visibility = \"hidden\";\n      puzzleCanvas.style.visibility = \"visible\";\n      btnAnswer.innerHTML = \"SHOW ANSWER\";\n    }\n  }\n  /*************** Number Blocks Puzzle Starts Here ********************\n   * Functions\n   * 1. processNumberBlocks()\n   * 2. makeNumberBlockPuzzle()\n   * 3. showNumberAnswer()\n   */\n  // just a dummy function that returns true\n  function processNumberBlocks() {\n    return true;\n  }\n  // this function generates the number blocks puzzle\n  function makeNumberBlockPuzzle() {\n    //usual canvas initialization stuff\n    var btnPuzzle = document.getElementById(\"btnReload\");\n    btnPuzzle.innerHTML = \"RELOAD PUZZLE\";\n    var btnAnswer = document.getElementById(\"btnAnswer\");\n    btnAnswer.innerHTML = \"SHOW ANSWER\";\n    var canvas = document.getElementById(\"puzzle-canvas\");\n    var ctx = canvas.getContext(\"2d\");\n    var canvas2 = document.getElementById(\"answer-canvas\");\n    var ctx2 = canvas2.getContext(\"2d\");\n    // clear the canvas\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx2.clearRect(0, 0, canvas2.width, canvas2.height);\n    ctx.font = \"16px verdana\";\n    ctx.textBaseline = \"middle\";\n    ctx.fillStyle = \"black\";\n    ctx2.font = \"16px verdana\";\n    ctx2.textBaseline = \"middle\";\n    ctx2.fillStyle = \"black\";\n    ctx.textAlign = \"center\";\n    ctx2.textAlign = \"center\";\n    var startX = 10;\n    var startY = 50;\n    var numberGrid = [];\n    var rowSum = [];\n    var colSum = [];\n    var diag1 = 0;\n    var diag2 = 0;\n    var clueIdx = [];\n    var cellWidth = 60;\n    var cellHeight = 30;\n    ctx.beginPath();\n    ctx2.beginPath();\n    // fill up every row of the grid with random integer and save the sums\n    for (var row = 0; row < blockSize; row++) {\n      numberGrid[row] = [];\n      var sum = 0;\n      for (var col = 0; col < blockSize; col++) {\n        var randomInteger =\n          Math.floor(Math.random() * (maxNumber - minNumber + 1)) + minNumber;\n        numberGrid[row][col] = randomInteger; // fill up the cells with random integer\n        sum += randomInteger; // add the integers\n      }\n      rowSum.push(sum); // save the result\n    }\n    // fill up every column of the grid with random integer and save the sums\n    for (col = 0; col < blockSize; col++) {\n      sum = 0;\n      for (row = 0; row < blockSize; row++) {\n        sum += numberGrid[row][col]; // add the integers\n      }\n      colSum.push(sum); // save the result\n    }\n    // calculate the diagonal sums\n    diag1 = 0;\n    for (row = 0; row < blockSize; row++) {\n      for (col = 0; col < blockSize; col++) {\n        if (row === col) diag1 += numberGrid[row][col];\n      }\n    }\n    diag2 = 0;\n    for (row = blockSize - 1, col = 0; row > -1; row--, col++) {\n      diag2 += numberGrid[row][col];\n    }\n    var i = 1;\n    var clueCells = [];\n    clueCells.push(Math.floor(Math.random() * blockSize)); //save the row\n    clueCells.push(Math.floor(Math.random() * blockSize)); // save the col\n    clueIdx.push(clueCells); // save one cell as clue number\n    while (i < numberBlockClueNo) {\n      // calculate all the clue number cells\n      var matching = false;\n      clueCells = [];\n      clueCells.push(Math.floor(Math.random() * blockSize)); //save the row\n      clueCells.push(Math.floor(Math.random() * blockSize)); // save the col\n      for (var j = 0; j < clueIdx.length; j++) {\n        // check if the cell is already present.\n        var currentClue = clueIdx[j];\n        if (currentClue === clueCells) {\n          matching = true; // if it does, the skip\n          break;\n        }\n      }\n      if (matching) continue;\n      clueIdx.push(clueCells); // else save the cell. these cells will be printed as clues\n      i++;\n    }\n    //now print the puzzle and answer\n    for (row = 0; row < blockSize; row++) {\n      for (col = 0; col < blockSize; col++) {\n        ctx.rect(\n          startX + col * cellWidth,\n          startY + row * cellHeight,\n          cellWidth,\n          cellHeight\n        );\n        ctx2.rect(\n          startX + col * cellWidth,\n          startY + row * cellHeight,\n          cellWidth,\n          cellHeight\n        );\n        ctx2.fillText(\n          numberGrid[row][col],\n          startX + col * cellWidth + cellWidth / 2,\n          startY + row * cellHeight + cellHeight / 2\n        );\n        ctx.stroke();\n        ctx2.stroke();\n      }\n    }\n    //diagonal 2 resullt\n    ctx.rect(\n      startX + 10 + col * cellWidth,\n      startY - cellHeight + 0 * cellHeight,\n      cellWidth,\n      cellHeight\n    );\n    ctx.fillText(\n      diag2,\n      startX + 10 + col * cellWidth + cellWidth / 2,\n      startY - cellHeight + 0 * cellHeight + cellHeight / 2\n    );\n    ctx2.rect(\n      startX + 10 + col * cellWidth,\n      startY - cellHeight + 0 * cellHeight,\n      cellWidth,\n      cellHeight\n    );\n    ctx2.fillText(\n      diag2,\n      startX + 10 + col * cellWidth + cellWidth / 2,\n      startY - cellHeight + 0 * cellHeight + cellHeight / 2\n    );\n    ctx.stroke();\n    ctx2.stroke();\n\n    // right-left sum\n    for (row = 0; row < blockSize; row++) {\n      ctx.rect(\n        startX + 10 + col * cellWidth,\n        startY + row * cellHeight,\n        cellWidth,\n        cellHeight\n      );\n      ctx.fillText(\n        rowSum[row],\n        startX + 10 + col * cellWidth + cellWidth / 2,\n        startY + row * cellHeight + cellHeight / 2\n      );\n      ctx2.rect(\n        startX + 10 + col * cellWidth,\n        startY + row * cellHeight,\n        cellWidth,\n        cellHeight\n      );\n      ctx2.fillText(\n        rowSum[row],\n        startX + 10 + col * cellWidth + cellWidth / 2,\n        startY + row * cellHeight + cellHeight / 2\n      );\n      ctx.stroke();\n      ctx2.stroke();\n    }\n    // top-bottom sup\n    for (col = 0; col < blockSize; col++) {\n      ctx.rect(\n        startX + col * cellWidth,\n        startY + 10 + row * cellHeight,\n        cellWidth,\n        cellHeight\n      );\n      ctx.fillText(\n        colSum[col],\n        startX + col * cellWidth + cellWidth / 2,\n        startY + 10 + row * cellHeight + cellHeight / 2\n      );\n      ctx2.rect(\n        startX + col * cellWidth,\n        startY + 10 + row * cellHeight,\n        cellWidth,\n        cellHeight\n      );\n      ctx2.fillText(\n        colSum[col],\n        startX + col * cellWidth + cellWidth / 2,\n        startY + 10 + row * cellHeight + cellHeight / 2\n      );\n      ctx.stroke();\n      ctx2.stroke();\n    }\n    // diagonal 1 sum\n    ctx.rect(\n      startX + 10 + col * cellWidth,\n      startY + 10 + row * cellHeight,\n      cellWidth,\n      cellHeight\n    );\n    ctx.fillText(\n      diag1,\n      startX + 10 + col * cellWidth + cellWidth / 2,\n      startY + 10 + row * cellHeight + cellHeight / 2\n    );\n    ctx2.rect(\n      startX + 10 + col * cellWidth,\n      startY + 10 + row * cellHeight,\n      cellWidth,\n      cellHeight\n    );\n    ctx2.fillText(\n      diag1,\n      startX + 10 + col * cellWidth + cellWidth / 2,\n      startY + 10 + row * cellHeight + cellHeight / 2\n    );\n    ctx.stroke();\n    ctx2.stroke();\n\n    //print the clue numbers\n    for (var n = 0; n < numberBlockClueNo; n++) {\n      clueCells = clueIdx[n];\n      row = clueCells[0];\n      col = clueCells[1];\n      ctx.fillText(\n        numberGrid[row][col],\n        startX + col * cellWidth + cellWidth / 2,\n        startY + row * cellHeight + cellHeight / 2\n      );\n    }\n  }\n  // function to show the answer\n  function showNumberAnswer() {\n    var answerCanvas = document.getElementById(\"answer-canvas\");\n    var puzzleCanvas = document.getElementById(\"puzzle-canvas\");\n    var btnAnswer = document.getElementById(\"btnAnswer\");\n    if (\n      answerCanvas.style.visibility === \"\" ||\n      answerCanvas.style.visibility === \"hidden\"\n    ) {\n      answerCanvas.style.visibility = \"visible\";\n      puzzleCanvas.style.visibility = \"hidden\";\n      btnAnswer.innerHTML = \"HIDE ANSWER\";\n    } else {\n      answerCanvas.style.visibility = \"hidden\";\n      puzzleCanvas.style.visibility = \"visible\";\n      btnAnswer.innerHTML = \"SHOW ANSWER\";\n    }\n  }\n  /********************** Cryptogram Code Starts Here ************************\n   * Functions\n   * 1. fillCryptoData()\n   * 2. processCryptoWords()\n   * 3. makeCryptogram()\n   * 4. showCryptoAnswer()\n   */\n  // this function fills the storage with sample data\n  function fillCryptoData() {\n    var data =\n      \"\\\"Don't cry because it's over, smile because it happened.\\\" Dr. Seuss\";\n    setCryptoPhrase(data);\n  }\n  // this function process the user input and signals if the makeCryptogram can be called\n  function processCryptoWords() {\n    var message = cryptoPhrase.replace(/\\s+/g, \" \").trim();\n    if (message.length < 10) {\n      alert(\"Give at least 10 letters in the cryto phrase\");\n      return false;\n    }\n    var clueletter = cryptoClues.replace(/\\s+/g, \"\").trim();\n    if (clueletter.length < 2) {\n      alert(\"Give at least 2 letters as clues\");\n      return false;\n    }\n    var area = document.getElementById(\"crypto-phrase\");\n    var lines = area.value.replace(/\\s+/g, \" \");\n    setCryptoPhrase(lines);\n    var noPunc = removePunctuations(lines);\n    cryptoPhraseNoSpace.current = removeSpace(noPunc);\n    return true;\n  }\n  // this is the cryptogram puzzle generator\n  const makeCryptogram = () => {\n    // usual canvas initialization\n    var canvas = document.getElementById(\"puzzle-canvas\");\n    var ctx = canvas.getContext(\"2d\");\n    var canvas2 = document.getElementById(\"answer-canvas\");\n    var ctx2 = canvas2.getContext(\"2d\");\n    ctx.lineWidth = 2;\n    ctx.font = \"14px verdana\";\n    ctx.textBaseline = \"middle\";\n    ctx.fillStyle = \"black\";\n    ctx.textAlign = \"center\";\n    ctx2.lineWidth = 2;\n    ctx2.font = \"14px verdana\";\n    ctx2.textBaseline = \"middle\";\n    ctx2.fillStyle = \"black\";\n    ctx2.textAlign = \"center\";\n    // clear the canvas\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx2.clearRect(0, 0, canvas.width, canvas.height);\n\n    var startX = 50;\n    var startY = 100;\n    var alphabet = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"; // A-Z alphabet letters\n    var shuffledAlphabet = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n    while (\n      shuffledAlphabet[0] === \"A\" ||\n      shuffledAlphabet[shuffledAlphabet.length - 1] === \"Z\" // make sure first letter is not A and last letter is not Z\n    )\n      // to avoid being too predictable\n      shuffledAlphabet = alphabet.shuffle(); // Shuffled A-Z alphabet letters\n    ctx.beginPath();\n    ctx2.beginPath(); // Draw the A-Z alphabet letters\n    for (var i = 0; i < alphabet.length; i++) {\n      ctx.rect(startX + i * 30, startY, 30, 30);\n      ctx.stroke();\n      ctx.fillText(alphabet[i], startX + i * 30 + 15, startY + 15);\n      ctx2.rect(startX + i * 30, startY, 30, 30);\n      ctx2.stroke();\n      ctx2.fillText(alphabet[i], startX + i * 30 + 15, startY + 15);\n    }\n    ctx2.fillStyle = \"gray\";\n    for (i = 0; i < alphabet.length; i++) {\n      ctx.rect(startX + i * 30, startY + 30, 30, 30);\n      ctx.stroke();\n      ctx2.rect(startX + i * 30, startY + 30, 30, 30);\n      ctx2.stroke();\n      if (cryptoOption === 1) {\n        // if option one is selected, then print the answer letters' crypto number\n        var x = shuffledAlphabet.indexOf(alphabet[i]);\n        ctx2.fillText(x + 1, startX + i * 30 + 15, startY + 30 + 15);\n      }\n      if (cryptoOption === 2) {\n        // if option two is selected, then print the answer letters themselves\n        ctx2.fillText(\n          shuffledAlphabet[i],\n          startX + i * 30 + 15,\n          startY + 30 + 15\n        );\n      }\n    }\n    for (i = 0; i < cryptoClues.length; i++) {\n      if (cryptoOption === 1) {\n        // if option 1 is selected, then print the clue letter's crypto number\n        var cellIndex = alphabet.indexOf(cryptoClues[i].toUpperCase());\n        x = shuffledAlphabet.indexOf(cryptoClues[i].toUpperCase());\n        ctx.fillText(x + 1, startX + cellIndex * 30 + 15, startY + 30 + 15);\n      }\n      if (cryptoOption === 2) {\n        // if option 2 is seleccted, then print the clue letters themselves\n        cellIndex = alphabet.indexOf(cryptoClues[i].toUpperCase());\n        ctx.fillText(\n          shuffledAlphabet[cellIndex],\n          startX + cellIndex * 30 + 15,\n          startY + 30 + 15\n        );\n      }\n    }\n\n    var answerY = startY + 100;\n    var lettersPerLine = 26;\n    var lineNo = Math.floor(cryptoPhrase.length / lettersPerLine);\n    // now print the answers that sit below the puzzle\n    for (var n = 0; n <= lineNo; n++) {\n      for (i = 0; i < lettersPerLine; i++) {\n        if (cryptoPhrase[i + n * lettersPerLine] === undefined) break;\n        var cl = cryptoClues.toUpperCase();\n        var cryptoPhraseUpper = cryptoPhrase.toUpperCase();\n        if (cl.includes(cryptoPhraseUpper[i + n * lettersPerLine]))\n          ctx.fillText(\n            cryptoPhraseUpper[i + n * lettersPerLine],\n            startX + i * 30 + 15,\n            answerY + n * 50 + 15\n          );\n        ctx2.fillText(\n          cryptoPhraseUpper[i + n * lettersPerLine],\n          startX + i * 30 + 15,\n          answerY + n * 50 + 15\n        );\n        if (isCharacterALetter(cryptoPhraseUpper[i + n * lettersPerLine])) {\n          ctx.moveTo(startX + i * 30 + 5, answerY + n * 50 + 30);\n          ctx.lineTo(startX + i * 30 + 25, answerY + n * 50 + 30);\n          ctx.stroke();\n          ctx2.moveTo(startX + i * 30 + 5, answerY + n * 50 + 30);\n          ctx2.lineTo(startX + i * 30 + 25, answerY + n * 50 + 30);\n          ctx2.stroke();\n          if (cryptoOption === 1) {\n            x = shuffledAlphabet.indexOf(\n              cryptoPhraseUpper[i + n * lettersPerLine]\n            );\n            ctx.fillText(\n              x + 1,\n              startX + i * 30 + 15,\n              answerY + n * 50 + 30 + 10\n            );\n            ctx2.fillText(\n              x + 1,\n              startX + i * 30 + 15,\n              answerY + n * 50 + 30 + 10\n            );\n          }\n          if (cryptoOption === 2) {\n            x = alphabet.indexOf(cryptoPhraseUpper[i + n * lettersPerLine]);\n            ctx.fillText(\n              shuffledAlphabet[x],\n              startX + i * 30 + 15,\n              answerY + n * 50 + 30 + 10\n            );\n            ctx2.fillText(\n              shuffledAlphabet[x],\n              startX + i * 30 + 15,\n              answerY + n * 50 + 30 + 10\n            );\n          }\n        }\n      }\n    }\n  };\n  // function to show the crypto answer\n  function showCryptoAnswer() {\n    var answerCanvas = document.getElementById(\"answer-canvas\");\n    var puzzleCanvas = document.getElementById(\"puzzle-canvas\");\n    var btnAnswer = document.getElementById(\"btnAnswer\");\n    if (\n      answerCanvas.style.visibility === \"\" ||\n      answerCanvas.style.visibility === \"hidden\"\n    ) {\n      answerCanvas.style.visibility = \"visible\";\n      puzzleCanvas.style.visibility = \"hidden\";\n      btnAnswer.innerHTML = \"HIDE ANSWER\";\n    } else {\n      answerCanvas.style.visibility = \"hidden\";\n      puzzleCanvas.style.visibility = \"visible\";\n      btnAnswer.innerHTML = \"SHOW ANSWER\";\n    }\n  }\n\n  // render jsx code starts here\n  // React's html rendering code\n  return (\n    <div className=\"App\" id=\"app\">\n      <div className=\"topArea\">\n        <img src={logo} alt=\"Logo\" />\n      </div>\n      <div className=\"container\">\n        <div className=\"row\">\n          <div className=\"column-left\">\n            <div>\n              <button id=\"creator\" className=\"button\">\n                Creator\n              </button>\n            </div>\n          </div>\n          <div className=\"column-left2\">\n            <div className=\"btn-group\">\n              <button\n                id=\"search\"\n                onClick={(e) => {\n                  if (currentPuzzle.current === \"search\") return;\n                  currentPuzzle.current = \"search\";\n                  clearCanvas();\n                  setSearchTitle(\"New Word Search Puzzle\");\n                  setSearchWords(\"Enter puzzle words or clues\");\n                  prepareSettings(\"search-settings\");\n                }}\n              >\n                Word Search\n              </button>\n              <button\n                id=\"cross\"\n                onClick={(e) => {\n                  if (currentPuzzle.current === \"cross\") return;\n                  currentPuzzle.current = \"cross\";\n                  clearCanvas();\n                  prepareSettings(\"cross-settings\");\n                }}\n              >\n                Cross Word\n              </button>\n              <button\n                id=\"double\"\n                onClick={(e) => {\n                  if (currentPuzzle.current === \"double\") return;\n                  currentPuzzle.current = \"double\";\n                  clearCanvas();\n                  prepareSettings(\"double-settings\");\n                }}\n              >\n                Double Puzzle\n              </button>\n              <button\n                id=\"fallen\"\n                onClick={(e) => {\n                  if (currentPuzzle.current === \"fallen\") return;\n                  currentPuzzle.current = \"fallen\";\n                  clearCanvas();\n                  prepareSettings(\"fallen-settings\");\n                }}\n              >\n                Fallen Phrase\n              </button>\n              <button\n                id=\"math\"\n                onClick={(e) => {\n                  if (currentPuzzle.current === \"math\") return;\n                  currentPuzzle.current = \"math\";\n                  clearCanvas();\n                  prepareSettings(\"math-settings\");\n                }}\n              >\n                Math Squares\n              </button>\n              <button\n                id=\"letter\"\n                onClick={(e) => {\n                  if (currentPuzzle.current === \"letter\") return;\n                  currentPuzzle.current = \"letter\";\n                  clearCanvas();\n                  prepareSettings(\"letter-settings\");\n                }}\n              >\n                Letter Tiles\n              </button>\n              <button\n                id=\"number\"\n                onClick={(e) => {\n                  if (currentPuzzle.current === \"number\") return;\n                  currentPuzzle.current = \"number\";\n                  clearCanvas();\n                  prepareSettings(\"numberblock-settings\");\n                }}\n              >\n                Number Blocks\n              </button>\n              <button\n                id=\"hidden\"\n                onClick={(e) => {\n                  if (currentPuzzle.current === \"hidden\") return;\n                  currentPuzzle.current = \"hidden\";\n                  clearCanvas();\n                  prepareSettings(\"hidden-settings\");\n                }}\n              >\n                Hidden Message\n              </button>\n              <button\n                id=\"crypto\"\n                onClick={(e) => {\n                  if (currentPuzzle.current === \"crypto\") return;\n                  currentPuzzle.current = \"crypto\";\n                  clearCanvas();\n                  prepareSettings(\"crypto-settings\");\n                }}\n              >\n                Cryptogram\n              </button>\n            </div>\n          </div>\n          <div id=\"puzzle-data\" className=\"column-middle\">\n            <div id=\"cross-settings\">\n              <h3>Criss-Cross Puzzle</h3>\n              <p>\n                To create your criss-cross puzzle, follow the steps below and\n                click the \"Create My Puzzle\" button when you are done.\n              </p>\n              <h5>1. Enter Puzzle Title</h5>\n              <p>\n                The title will appear at the top of your page. (24 characters or\n                fewer.)\n              </p>\n              <input\n                type=\"text\"\n                size=\"25\"\n                className=\"textinput\"\n                value={crossTitle}\n                placeholder={crossTitle}\n                onChange={(e) => {\n                  setCrossTitle((pre) => (pre = e.target.value));\n                }}\n              ></input>\n              <br></br>\n              <h5>2. Enter Your Words and Clues</h5>\n              <p>\n                On each line enter a word followed by a comma and then the clue\n                for that word. Press enter to go to next line.\n              </p>\n              <textarea\n                id=\"cross-words\"\n                name=\"words\"\n                rows=\"5\"\n                cols=\"40\"\n                value={crossWords}\n                placeholder={crossWords}\n                spellCheck=\"false\"\n                onChange={(e) => {\n                  setCrossWords(e.target.value);\n                }}\n              ></textarea>\n              <a\n                href=\"/\"\n                onClick={(ev) => {\n                  ev.preventDefault();\n                  fillCrossData();\n                }}\n              >\n                <p>Fill with sample data</p>\n              </a>\n              <h5>3. Show instructions</h5>\n              <input\n                type=\"checkbox\"\n                id=\"instructions\"\n                name=\"instructions\"\n                checked={putInstructions}\n                onChange={(e) => {\n                  if (putInstructions)\n                    document.getElementById(\"instruction\").style.visibility =\n                      \"hidden\";\n                  else\n                    document.getElementById(\"instruction\").style.visibility =\n                      \"visible\";\n                  setPutInstructions(e.target.checked);\n                  //console.log(e);\n                }}\n              ></input>\n              <label htmlFor=\"instructions\">\n                {\" \"}\n                Check this box if you want instructions to appear above the\n                puzzle.\n              </label>\n              <br></br>\n              <br></br>\n              <button\n                id=\"createCross\"\n                className=\"button\"\n                onClick={(e) => {\n                  if (processCrossWords()) {\n                    preparePuzzle(crossInstructiions, \"clues\", \"cross\");\n                    resetCanvas();\n                  }\n                }}\n              >\n                CREAT MY PUZZLE\n              </button>\n              <br></br>\n              <br></br>\n            </div>\n            <div id=\"numberblock-settings\">\n              <h3>Number Blocks Puzzle</h3>\n              <p>\n                To create your number blocks puzzle, follow the steps below and\n                click the \"Create My Puzzle\" button when you are done.\n              </p>\n              <h5>1. Enter a title for your puzzle</h5>\n              <p>\n                The title will appear at the top of your page. (24 characters or\n                fewer.)\n              </p>\n              <input\n                type=\"text\"\n                size=\"50\"\n                className=\"textinput\"\n                value={numberBlocksTitle}\n                placeholder={numberBlocksTitle}\n                onChange={(e) => {\n                  setNumberBlocksTitle((pre) => (pre = e.target.value));\n                }}\n              ></input>\n              <br></br>\n              <h5>2. Enter the size of your number block</h5>\n              <p>\n                Your number block can be as small as 3 x 3 or as large as 10 x\n                10. Enter a number below.\n              </p>\n              <input\n                type=\"text\"\n                size=\"5\"\n                className=\"textinput\"\n                value={blockSize}\n                placeholder={blockSize}\n                onChange={(e) => {\n                  setBlockSize((pre) => (pre = e.target.value));\n                  // setUpperNumber(e.target.value * e.target.value);\n                }}\n              ></input>\n              <br></br>\n              <h5>3. Enter a range for the numbers that will fill the grid</h5>\n              <p>\n                Specify the range of numbers for the values of the grid. The\n                smaller the range of numbers, the easier the puzzle.\n              </p>\n              <input\n                type=\"text\"\n                size=\"5\"\n                className=\"textinput\"\n                value={minNumber}\n                placeholder={\"Minimum \" + minNumber}\n                onChange={(e) => {\n                  setMinNumber((pre) => (pre = e.target.value));\n                }}\n              ></input>\n              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n              <input\n                type=\"text\"\n                size=\"5\"\n                className=\"textinput\"\n                value={maxNumber}\n                placeholder={\"Maximum \" + maxNumber}\n                onChange={(e) => {\n                  setMaxNumber((pre) => (pre = e.target.value));\n                }}\n              ></input>\n              <br></br>\n              <h5>4. Giveaway some numbers?</h5>\n              <p>\n                To make the puzzle a little easier you can choose to fill in\n                some of the numbers to start.\n              </p>\n              <input\n                type=\"text\"\n                size=\"5\"\n                className=\"textinput\"\n                value={numberBlockClueNo}\n                placeholder={numberBlockClueNo}\n                onChange={(e) => {\n                  setNumberBlockClueNo((pre) => (pre = e.target.value));\n                }}\n              ></input>\n              <br></br>\n              <h5>5. Show instructions</h5>\n              <input\n                type=\"checkbox\"\n                id=\"numberblock-instruction\"\n                name=\"numberblock-instructions\"\n                checked={putInstructions}\n                onChange={(e) => {\n                  if (putInstructions)\n                    document.getElementById(\n                      \"puzzle-instructions\"\n                    ).style.display = \"none\";\n                  else\n                    document.getElementById(\n                      \"puzzle-instructions\"\n                    ).style.display = \"block\";\n                  setPutInstructions(e.target.checked);\n                }}\n              ></input>\n              <label htmlFor=\"numberblock-instruction\">\n                {\" \"}\n                Check this box if you want instructions to appear above the\n                puzzle.\n              </label>\n              <br></br>\n              <br></br>\n              <button\n                id=\"createNumberBlock\"\n                className=\"button\"\n                onClick={(e) => {\n                  if (processNumberBlocks()) {\n                    preparePuzzle(numberBlockInstructions, \"clues\", \"number\");\n                    resetCanvas();\n                  }\n                }}\n              >\n                CREAT MY PUZZLE\n              </button>\n              <br></br>\n              <br></br>\n            </div>\n            <div id=\"letter-settings\">\n              <h3>Letter Tiles Puzzle</h3>\n              <p>\n                To create your letter tiles puzzle, follow the steps below and\n                click the \"Create My Puzzle\" button when you are done.\n              </p>\n              <h5>1. Enter a title for your puzzle</h5>\n              <p>\n                The title will appear at the top of your page. (24 characters or\n                fewer.)\n              </p>\n              <input\n                type=\"text\"\n                size=\"50\"\n                className=\"textinput\"\n                value={letterTitle}\n                placeholder={letterTitle}\n                onChange={(e) => {\n                  setLetterTitle((pre) => (pre = e.target.value));\n                }}\n              ></input>\n              <br></br>\n              <h5>2. Enter the phrase</h5>\n              <p>Enter the phrase to be scrambled.</p>\n              <textarea\n                id=\"letter-words\"\n                name=\"letter\"\n                rows=\"5\"\n                cols=\"40\"\n                value={letterPhrase}\n                placeholder=\"Write the phrase here.\"\n                spellCheck=\"false\"\n                onChange={(e) => {\n                  var ip = e.target.value;\n                  setLetterPhrase(ip);\n                }}\n              ></textarea>\n              <a\n                href=\"/\"\n                onClick={(ev) => {\n                  ev.preventDefault();\n                  fillLetterData();\n                }}\n              >\n                <p>Fill with sample data</p>\n              </a>\n              <h5>3. How many letters should be on each tile?</h5>\n              <p>Three is a typical number</p>\n              <input\n                type=\"radio\"\n                id=\"letter-option1\"\n                name=\"letterOption\"\n                checked={numberOfLetter === 2 ? true : false}\n                onChange={(e) => {\n                  setNumberOfLetter(2);\n                }}\n              ></input>\n              <label htmlFor=\"letter-option1\">Two</label>\n              <br></br>\n              <input\n                type=\"radio\"\n                id=\"letter-option2\"\n                name=\"letterOption\"\n                checked={numberOfLetter === 3 ? true : false}\n                onChange={(e) => {\n                  setNumberOfLetter(3);\n                }}\n              ></input>\n              <label htmlFor=\"letter-option2\">Three</label>\n              <br></br>\n              <input\n                type=\"radio\"\n                id=\"letter-option3\"\n                name=\"letterOption\"\n                checked={numberOfLetter === 4 ? true : false}\n                onChange={(e) => {\n                  setNumberOfLetter(4);\n                }}\n              ></input>\n              <label htmlFor=\"letter-option3\">Four</label>\n              <br></br>\n              <h5>4. Show the answer area</h5>\n              <input\n                type=\"checkbox\"\n                id=\"letter-answer\"\n                name=\"letter-answer\"\n                checked={showLetterAnswerArea}\n                onChange={(e) => {\n                  setShowLetterAnswerArea(e.target.checked);\n                }}\n              ></input>\n              <label htmlFor=\"letter-answer\">\n                Check this box if you want empty boxes to appear below the\n                tiles. These boxes will give the solver a place to write the\n                letters.\n              </label>\n              <br></br>\n              <h5>5. Show instructions</h5>\n              <input\n                type=\"checkbox\"\n                id=\"letter-instruction\"\n                name=\"letter-instructions\"\n                checked={putInstructions}\n                onChange={(e) => {\n                  if (putInstructions)\n                    document.getElementById(\n                      \"puzzle-instructions\"\n                    ).style.display = \"none\";\n                  else\n                    document.getElementById(\n                      \"puzzle-instructions\"\n                    ).style.display = \"block\";\n                  setPutInstructions(e.target.checked);\n                }}\n              ></input>\n              <label htmlFor=\"letter-instruction\">\n                {\" \"}\n                Check this box if you want instructions to appear above the\n                puzzle.\n              </label>\n              <br></br>\n              <br></br>\n              <button\n                id=\"createLetter\"\n                className=\"button\"\n                onClick={(e) => {\n                  if (processLetterTiles()) {\n                    preparePuzzle(letterInstructions, \"clues\", \"letter\");\n                    resetCanvas();\n                  }\n                }}\n              >\n                CREAT MY PUZZLE\n              </button>\n              <br></br>\n              <br></br>\n            </div>\n            <div id=\"math-settings\">\n              <h3>Math Squares Puzzle</h3>\n              <p>\n                To create your math squares puzzle, follow the steps below and\n                click the \"Create My Puzzle\" button when you are done.\n              </p>\n              <h5>1. Enter a title for your puzzle</h5>\n              <p>\n                The title will appear at the top of your page. (24 characters or\n                fewer.)\n              </p>\n              <input\n                type=\"text\"\n                size=\"50\"\n                className=\"textinput\"\n                value={mathTitle}\n                placeholder={mathTitle}\n                onChange={(e) => {\n                  setMathTitle((pre) => (pre = e.target.value));\n                }}\n              ></input>\n              <br></br>\n              <h5>2. Enter the size of your math square</h5>\n              <p>\n                Your math square can be as small as 3 x 3 or as large as 10 x\n                10. The dimensions must equal. Enter a number below.\n              </p>\n              <input\n                type=\"text\"\n                size=\"5\"\n                className=\"textinput\"\n                value={squireSize}\n                placeholder={squireSize}\n                onChange={(e) => {\n                  setSquireSize((pre) => (pre = e.target.value));\n                  setUpperNumber(e.target.value * e.target.value);\n                }}\n              ></input>\n              <br></br>\n              <h5>3. Giveaway some numbers?</h5>\n              <p>\n                To make the puzzle a little easier you can choose to fill in\n                some of the numbers to start.\n              </p>\n              <input\n                type=\"text\"\n                size=\"5\"\n                className=\"textinput\"\n                value={mathClueNo}\n                placeholder={mathClueNo}\n                onChange={(e) => {\n                  setMathClueNo((pre) => (pre = e.target.value));\n                }}\n              ></input>\n              <br></br>\n              <h5>4. Choose the operators</h5>\n              <p>\n                Select the mathematical operators you would like to use.\n                Addition may be used in some puzzles when not selected.\n              </p>\n              <input\n                type=\"checkbox\"\n                id=\"math-addition\"\n                name=\"math-addition\"\n                checked={opAddition}\n                onChange={(e) => {\n                  setOpAddition(e.target.checked);\n                }}\n              ></input>\n              <label htmlFor=\"math-addition\">Addition</label>\n              <br></br>\n              <input\n                type=\"checkbox\"\n                id=\"math-subtraction\"\n                name=\"math-subtraction\"\n                checked={opSubtraction}\n                onChange={(e) => {\n                  setOpSubtraction(e.target.checked);\n                }}\n              ></input>\n              <label htmlFor=\"math-subtraction\">Subtraction</label>\n              <br></br>\n              <input\n                type=\"checkbox\"\n                id=\"math-multiplication\"\n                name=\"math-multiplication\"\n                checked={opMultiiplication}\n                onChange={(e) => {\n                  setOpMultiiplication(e.target.checked);\n                }}\n              ></input>\n              <label htmlFor=\"math-multiplication\">Multiplication</label>\n              <br></br>\n              <input\n                type=\"checkbox\"\n                id=\"math-division\"\n                name=\"math-division\"\n                checked={opDivision}\n                onChange={(e) => {\n                  setOpDivision(e.target.checked);\n                }}\n              ></input>\n              <label htmlFor=\"math-division\">Division</label>\n              <br></br>\n              <h5>5. Show instructions</h5>\n              <input\n                type=\"checkbox\"\n                id=\"math-instruction\"\n                name=\"math-instructions\"\n                checked={putInstructions}\n                onChange={(e) => {\n                  if (putInstructions)\n                    document.getElementById(\n                      \"puzzle-instructions\"\n                    ).style.display = \"none\";\n                  else\n                    document.getElementById(\n                      \"puzzle-instructions\"\n                    ).style.display = \"block\";\n                  setPutInstructions(e.target.checked);\n                }}\n              ></input>\n              <label htmlFor=\"fallen-instruction\">\n                {\" \"}\n                Check this box if you want instructions to appear above the\n                puzzle.\n              </label>\n              <br></br>\n              <br></br>\n              <button\n                id=\"createMath\"\n                className=\"button\"\n                onClick={(e) => {\n                  if (processMathSquares()) {\n                    preparePuzzle(mathInstructions, \"clues\", \"math\");\n                    resetCanvas();\n                  }\n                }}\n              >\n                CREAT MY PUZZLE\n              </button>\n              <br></br>\n              <br></br>\n            </div>\n            <div id=\"fallen-settings\">\n              <h3>Fallen Phrase Puzzle</h3>\n              <p>\n                To create your fallen phrase puzzle, follow the steps below and\n                click the \"Create My Puzzle\" button when you are done.\n              </p>\n              <h5>1. Enter a title for your puzzle</h5>\n              <p>\n                The title will appear at the top of your page. (24 characters or\n                fewer.)\n              </p>\n              <input\n                type=\"text\"\n                size=\"50\"\n                className=\"textinput\"\n                value={fallenTitle}\n                placeholder={fallenTitle}\n                onChange={(e) => {\n                  setFallenTitle((pre) => (pre = e.target.value));\n                }}\n              ></input>\n              <br></br>\n              <h5>2. Enter your phrase</h5>\n              <p>\n                Enter the phrase to be solved. The phrase must be at least 40\n                characters long to property scramble the puzzle.\n              </p>\n              <textarea\n                id=\"fallen-words\"\n                name=\"fallen\"\n                rows=\"5\"\n                cols=\"40\"\n                value={fallenWords}\n                placeholder={fallenWords}\n                spellCheck=\"false\"\n                onChange={(e) => {\n                  var ip = e.target.value;\n                  setFallenWords(ip.toUpperCase());\n                }}\n              ></textarea>\n              <a\n                href=\"/\"\n                onClick={(ev) => {\n                  ev.preventDefault();\n                  fillFallenData();\n                }}\n              >\n                <p>Fill with sample data</p>\n              </a>\n              <h5>3. Giveaway a some letters?</h5>\n              <p>\n                To make the puzzle a little easier you can choose to fill in\n                some of the letters to start.\n              </p>\n              <input\n                type=\"text\"\n                size=\"5\"\n                className=\"textinput\"\n                value={fallenClueNo}\n                placeholder={fallenClueNo}\n                onChange={(e) => {\n                  setFallenClueNo((pre) => (pre = e.target.value));\n                }}\n              ></input>\n              <br></br>\n              <h5>5. Show instructions</h5>\n              <input\n                type=\"checkbox\"\n                id=\"fallen-instruction\"\n                name=\"fallen-instructions\"\n                checked={putInstructions}\n                onChange={(e) => {\n                  if (putInstructions)\n                    document.getElementById(\n                      \"puzzle-instructions\"\n                    ).style.display = \"none\";\n                  else\n                    document.getElementById(\n                      \"puzzle-instructions\"\n                    ).style.display = \"block\";\n                  setPutInstructions(e.target.checked);\n                  //console.log(e);\n                }}\n              ></input>\n              <label htmlFor=\"fallen-instruction\">\n                {\" \"}\n                Check this box if you want instructions to appear above the\n                puzzle.\n              </label>\n              <br></br>\n              <br></br>\n              <button\n                id=\"createFallen\"\n                className=\"button\"\n                onClick={(e) => {\n                  if (processFallenWords()) {\n                    preparePuzzle(fallenInstructions, \"clues\", \"fallen\");\n                    resetCanvas();\n                  }\n                }}\n              >\n                CREAT MY PUZZLE\n              </button>\n              <br></br>\n              <br></br>\n            </div>\n            <div id=\"crypto-settings\">\n              <h3>Cryptogram Puzzle</h3>\n              <p>\n                To create your cryptogram puzzle, follow the steps below and\n                click the \"Create My Puzzle\" button when you are done.\n              </p>\n              <h5>1. Enter a title for your puzzle</h5>\n              <p>\n                The title will appear at the top of your page. (24 characters or\n                fewer.)\n              </p>\n              <input\n                type=\"text\"\n                size=\"50\"\n                className=\"textinput\"\n                value={cryptoTitle}\n                placeholder={\"Enter Title\"}\n                onChange={(e) => {\n                  setCryptoTitle(e.target.value);\n                }}\n              ></input>\n              <br></br>\n              <h5>2. Enter your phrase you want to encrypt</h5>\n              <textarea\n                id=\"crypto-phrase\"\n                name=\"crypto\"\n                rows=\"5\"\n                cols=\"40\"\n                value={cryptoPhrase}\n                placeholder={\"Enter Phrase\"}\n                spellCheck=\"false\"\n                onChange={(e) => {\n                  var ip = e.target.value;\n                  setCryptoPhrase(ip);\n                }}\n              ></textarea>\n              <a\n                href=\"/\"\n                onClick={(ev) => {\n                  ev.preventDefault();\n                  fillCryptoData();\n                }}\n              >\n                <p>Fill with sample data</p>\n              </a>\n              <h5>3. Choose a character style</h5>\n              <p>\n                Pick the type of characters you want to use to replace the\n                letters in the phrase.\n              </p>\n              <input\n                type=\"radio\"\n                id=\"crypto-option1\"\n                name=\"cryptoOption\"\n                checked={cryptoOption === 1 ? true : false}\n                onChange={(e) => {\n                  setCryptoOption(1);\n                }}\n              ></input>\n              <label htmlFor=\"crypto-option1\">Numbers</label>\n              <br></br>\n              <input\n                type=\"radio\"\n                id=\"crypto-option2\"\n                name=\"cryptoOption\"\n                checked={cryptoOption === 2 ? true : false}\n                onChange={(e) => {\n                  setCryptoOption(2);\n                }}\n              ></input>\n              <label htmlFor=\"crypto-option2\">English Letters</label>\n              <br></br>\n              <h5>4. Giveaway a some letters?</h5>\n              <p>\n                You can choose to give away some of the letters in the\n                cryptogram to give the solver a head start. Enter the letters\n                you want to give away below.\n              </p>\n              <input\n                type=\"text\"\n                size=\"20\"\n                className=\"textinput\"\n                value={cryptoClues}\n                placeholder={\"Enter letters\"}\n                onChange={(e) => {\n                  setCryptoClues(e.target.value);\n                }}\n              ></input>\n              <br></br>\n              <h5>5. Show instructions</h5>\n              <input\n                type=\"checkbox\"\n                id=\"crypto-instruction\"\n                name=\"crypto-instructions\"\n                checked={putInstructions}\n                onChange={(e) => {\n                  if (putInstructions)\n                    document.getElementById(\n                      \"puzzle-instructions\"\n                    ).style.display = \"none\";\n                  else\n                    document.getElementById(\n                      \"puzzle-instructions\"\n                    ).style.display = \"block\";\n                  setPutInstructions(e.target.checked);\n                }}\n              ></input>\n              <label htmlFor=\"crypto-instruction\">\n                {\" \"}\n                Check this box if you want instructions to appear above the\n                puzzle.\n              </label>\n              <br></br>\n              <br></br>\n              <button\n                id=\"createCrypto\"\n                className=\"button\"\n                onClick={(e) => {\n                  if (processCryptoWords()) {\n                    preparePuzzle(cryptoInstructions, \"clues\", \"crypto\");\n                    resetCanvas();\n                  }\n                }}\n              >\n                CREAT MY PUZZLE\n              </button>\n              <br></br>\n              <br></br>\n            </div>\n\n            <div id=\"double-settings\">\n              <h3>Double Puzzle</h3>\n              <p>\n                To create your double puzzle, follow the steps below and click\n                the \"Create My Puzzle\" button when you are done.\n              </p>\n              <h5>1. Enter a title for your puzzle</h5>\n              <p>\n                The title will appear at the top of your page. (24 characters or\n                fewer.)\n              </p>\n              <input\n                type=\"text\"\n                size=\"50\"\n                className=\"textinput\"\n                value={doubleTitle}\n                placeholder={doubleTitle}\n                onChange={(e) => {\n                  setDoubleTitle((pre) => (pre = e.target.value));\n                }}\n              ></input>\n              <br></br>\n              <h5>2. Enter your words</h5>\n              <p>Enter each word or phrase on its own line.</p>\n              <textarea\n                id=\"double-words\"\n                name=\"double\"\n                rows=\"5\"\n                cols=\"40\"\n                value={doubleWords}\n                placeholder={doubleWords}\n                spellCheck=\"false\"\n                onChange={(e) => {\n                  var ip = e.target.value;\n                  setDoubleWords(ip.toUpperCase());\n                }}\n              ></textarea>\n              <a\n                href=\"/\"\n                onClick={(ev) => {\n                  ev.preventDefault();\n                  fillDoubleData();\n                }}\n              >\n                <p>Fill with sample data</p>\n              </a>\n              <h5>3. Enter the final word or phrase for your puzzle</h5>\n              <p>\n                Enter the word or phrase that will be created by combining the\n                letters from the words input in the box above.\n              </p>\n              <input\n                type=\"text\"\n                size=\"50\"\n                className=\"textinput\"\n                value={finalWord}\n                placeholder={finalWord}\n                onChange={(e) => {\n                  var ip = e.target.value;\n                  setFinalWord((pre) => (pre = ip.toUpperCase()));\n                }}\n              ></input>\n              <a\n                href=\"/\"\n                onClick={(ev) => {\n                  ev.preventDefault();\n                  fillFinalWord();\n                }}\n              >\n                <p>Fill with sample data</p>\n              </a>\n              <h5>4. Numbered or scrambled phrase</h5>\n              <p>\n                The final phrase is made up of letters from the clue words you\n                input above. The letters can be scrambled, giving the solver\n                another challenge, or the letters can be numbered, making the\n                puzzle a little easier to solve.\n              </p>\n              <input\n                type=\"radio\"\n                id=\"double-option1\"\n                name=\"doubleOption\"\n                checked={doubleOption === 1 ? true : false}\n                onChange={(e) => {\n                  setDoubeOption(1);\n                }}\n              ></input>\n              <label htmlFor=\"double-option1\">\n                Scrambled (this option is best for short words)\n              </label>\n              <br></br>\n              <input\n                type=\"radio\"\n                id=\"double-option2\"\n                name=\"doubleOption\"\n                checked={doubleOption === 2 ? true : false}\n                onChange={(e) => {\n                  setDoubeOption(2);\n                }}\n              ></input>\n              <label htmlFor=\"double-option2\">\n                Numbered (this option is best for longer phrases, names or\n                unusual words)\n              </label>\n              <br></br>\n              <h5>5. Show instructions</h5>\n              <input\n                type=\"checkbox\"\n                id=\"double-instruction\"\n                name=\"double-instructions\"\n                checked={putInstructions}\n                onChange={(e) => {\n                  if (putInstructions)\n                    document.getElementById(\n                      \"puzzle-instructions\"\n                    ).style.display = \"none\";\n                  else\n                    document.getElementById(\n                      \"puzzle-instructions\"\n                    ).style.display = \"block\";\n                  setPutInstructions(e.target.checked);\n                  //console.log(e);\n                }}\n              ></input>\n              <label htmlFor=\"double-instruction\">\n                {\" \"}\n                Check this box if you want instructions to appear above the\n                puzzle.\n              </label>\n              <br></br>\n              <br></br>\n              <button\n                id=\"createDouble\"\n                className=\"button\"\n                onClick={(e) => {\n                  if (processDoubleWords()) {\n                    preparePuzzle(doubleInstructions, \"clues\", \"double\");\n                    resetCanvas();\n                  }\n                }}\n              >\n                CREAT MY PUZZLE\n              </button>\n              <br></br>\n              <br></br>\n            </div>\n            <div id=\"hidden-settings\">\n              <h3>Hidden Message Puzzle</h3>\n              <p>\n                To create your hidden message puzzle, follow the steps below and\n                click the Create My Puzzle button when you are done.\n              </p>\n              <h5>1. Enter a title for your puzzle</h5>\n              <p>\n                The title will appear at the top of your page. (24 characters or\n                fewer.)\n              </p>\n              <input\n                type=\"text\"\n                size=\"50\"\n                className=\"textinput\"\n                value={hiddenTitle}\n                placeholder={\"Enter Title\"}\n                onChange={(e) => {\n                  setHideenTitle((pre) => (pre = e.target.value));\n                }}\n              ></input>\n              <br></br>\n              <h5>2. Enter the message to be hidden in your puzzle</h5>\n              <p>\n                The letters in the message will be hidden between the words you\n                input below. When the person solving the puzzle finds all the\n                words, the hidden message will be revealed.\n              </p>\n              <input\n                type=\"text\"\n                size=\"50\"\n                className=\"textinput\"\n                value={hiddenMessage}\n                placeholder={\"Enter the hidden message\"}\n                onChange={(e) => {\n                  setHiddenMessage((pre) => (pre = e.target.value));\n                }}\n              ></input>\n              <br></br>\n              <button\n                className=\"buttonSmall\"\n                onClick={(e) => {\n                  var sw = \"Let's go to the zoo!\";\n                  setHiddenMessage(sw);\n                }}\n              >\n                Fill with Sample Data\n              </button>\n              <br></br>\n              <h5>3. Enter the size of your word search puzzle</h5>\n              <p>\n                Your puzzle can be up to 40 letters by 40 letters and still fit\n                on one page. The optimum puzzle size is 15 letters by 15\n                letters.\n              </p>\n              <div className=\"sameLine\">\n                <p>Number of Letters </p>\n                <input\n                  type=\"text\"\n                  size=\"10\"\n                  className=\"textinput\"\n                  value={letterAcross}\n                  placeholder={letterAcross}\n                  onChange={(e) => {\n                    setAcross((pre) => (pre = e.target.value));\n                    setDown((pre) => (pre = e.target.value));\n                  }}\n                ></input>\n              </div>\n              <br></br>\n              <h5>4. Case Options</h5>\n              <p>\n                Choose if you would like your puzzle to be built using all\n                uppercase, all lowercase or mixed case letters.\n              </p>\n              <input\n                type=\"radio\"\n                id=\"option-upper\"\n                name=\"caseoption\"\n                checked={caseOption === 1 ? true : false}\n                onChange={(e) => {\n                  setCaseOption(1);\n                }}\n              ></input>\n              <label htmlFor=\"option-upper\">All Uppercase Letters</label>\n              <br></br>\n              <input\n                type=\"radio\"\n                id=\"option-mixed\"\n                name=\"caseoption\"\n                checked={caseOption === 2 ? true : false}\n                onChange={(e) => {\n                  setCaseOption(2);\n                }}\n              ></input>\n              <label htmlFor=\"option-mixed\">\n                Mixed Uppercase and Lowercase Letters\n              </label>\n              <br></br>\n              <input\n                type=\"radio\"\n                id=\"option-lower\"\n                name=\"caseoption\"\n                checked={caseOption === 3 ? true : false}\n                onChange={(e) => {\n                  setCaseOption(3);\n                }}\n              ></input>\n              <label htmlFor=\"option-lower\">All Lowercase Letters</label>\n              <br></br>\n              <h5>5. Enter your words</h5>\n              <p>Separate your words with a single space.</p>\n              <textarea\n                id=\"hidden-search-words\"\n                name=\"hidden-search-words\"\n                rows=\"3\"\n                cols=\"40\"\n                value={hiddenSearchWords}\n                placeholder={\"Enter puzzle words or clues\"}\n                spellCheck=\"false\"\n                onChange={(e) => {\n                  setHiddenSearchWords(e.target.value);\n                }}\n              ></textarea>\n              <br></br>\n              <button\n                className=\"buttonSmall\"\n                onClick={(e) => {\n                  var sw =\n                    \"Penguin Goat Panda Giraffe PolarBear Lion Tiger Elephant Meerkat Bear Toad Frog Alligator Stork Monkey\";\n                  setHiddenSearchWords(sw);\n                }}\n              >\n                Fill with Sample Data\n              </button>\n              <br></br>\n              <br></br>\n              <h5>6. Show instructions</h5>\n              <input\n                type=\"checkbox\"\n                id=\"instructions\"\n                name=\"instructions\"\n                checked={putInstructions}\n                onChange={(e) => {\n                  setPutInstructions(e.target.checked);\n                }}\n              ></input>\n              <label htmlFor=\"instructions\">\n                {\" \"}\n                Check this box if you want instructions to appear below the\n                puzzle.\n              </label>\n              <br></br>\n              <button\n                className=\"button\"\n                onClick={(e) => {\n                  if (processHiddenMessage()) {\n                    preparePuzzle(hiddenInstructions, \"no clues\", \"hidden\");\n                    console.log(searchGrid.current);\n                  }\n\n                  resetCanvas();\n                  console.log(searchGrid.current);\n                }}\n              >\n                Create My Puzzle\n              </button>\n              <br></br>\n              <br></br>\n            </div>\n\n            <div id=\"search-settings\">\n              <h3>Word Search Puzzle</h3>\n              <p>\n                To create your word search puzzle, follow the steps below and\n                click the Create My Puzzle button when you are done.\n              </p>\n              <h5>1. Enter a title for your puzzle</h5>\n              <p>\n                The title will appear at the top of your page. (24 characters or\n                fewer.)\n              </p>\n              <input\n                type=\"text\"\n                size=\"50\"\n                className=\"textinput\"\n                value={searchTitle}\n                placeholder={searchTitle}\n                onChange={(e) => {\n                  setSearchTitle((pre) => (pre = e.target.value));\n                }}\n              ></input>\n              <br></br>\n              <h5>2. Enter the size of your word search puzzle</h5>\n              <p>\n                Your puzzle can be up to 40 letters by 40 letters and still fit\n                on one page. The optimum puzzle size is 15 letters by 15\n                letters.\n              </p>\n              <div className=\"sameLine\">\n                <p>Number of Letters </p>\n                <input\n                  type=\"text\"\n                  size=\"10\"\n                  className=\"textinput\"\n                  value={letterAcross}\n                  placeholder={letterAcross}\n                  onChange={(e) => {\n                    setAcross((pre) => (pre = e.target.value));\n                    setDown((pre) => (pre = e.target.value));\n                  }}\n                ></input>\n              </div>\n              <br></br>\n              <h5>3. Word search puzzle options</h5>\n              <p>\n                Puzzles where the words do not share any letters are faster to\n                generate and easier to solve. If you choose to share letters as\n                much as possible, the computer will take a little longer to\n                generate the puzzle.\n              </p>\n              <input\n                type=\"radio\"\n                id=\"search-option1\"\n                name=\"searchOption\"\n                checked={searchOption === 1 ? true : false}\n                //value={searchOption}\n                onChange={(e) => {\n                  setSearchOption(1);\n                  //console.log(e.target.value + 1);\n                }}\n              ></input>\n              <label htmlFor=\"search-option1\">Use each letter only once.</label>\n              <br></br>\n              <input\n                type=\"radio\"\n                id=\"search-option2\"\n                name=\"searchOption\"\n                //value={searchOption}\n                checked={searchOption === 2 ? true : false}\n                onChange={(e) => {\n                  setSearchOption(2);\n                  //console.log(e.target.value + 2);\n                }}\n              ></input>\n              <label htmlFor=\"search-option2\">\n                Share letters occasionally.\n              </label>\n              <br></br>\n              <input\n                type=\"radio\"\n                id=\"search-option3\"\n                name=\"searchOption\"\n                checked={searchOption === 3 ? true : false}\n                onChange={(e) => {\n                  setSearchOption(3);\n                }}\n              ></input>\n              <label htmlFor=\"search-option3\">\n                Share letters as much as possible.\n              </label>\n              <br></br>\n              <h5>4. Case Options</h5>\n              <p>\n                Choose if you would like your puzzle to be built using all\n                uppercase, all lowercase or mixed case letters.\n              </p>\n              <input\n                type=\"radio\"\n                id=\"option-upper\"\n                name=\"caseoption\"\n                checked={caseOption === 1 ? true : false}\n                onChange={(e) => {\n                  setCaseOption(1);\n                }}\n              ></input>\n              <label htmlFor=\"option-upper\">All Uppercase Letters</label>\n              <br></br>\n              <input\n                type=\"radio\"\n                id=\"option-mixed\"\n                name=\"caseoption\"\n                checked={caseOption === 2 ? true : false}\n                onChange={(e) => {\n                  setCaseOption(2);\n                }}\n              ></input>\n              <label htmlFor=\"option-mixed\">\n                Mixed Uppercase and Lowercase Letters\n              </label>\n              <br></br>\n              <input\n                type=\"radio\"\n                id=\"option-lower\"\n                name=\"caseoption\"\n                checked={caseOption === 3 ? true : false}\n                onChange={(e) => {\n                  setCaseOption(3);\n                }}\n              ></input>\n              <label htmlFor=\"option-lower\">All Lowercase Letters</label>\n              <br></br>\n              <h5>6. Enter your words</h5>\n              <p>Separate your words with a single space.</p>\n              <textarea\n                id=\"search-words\"\n                name=\"searchwords\"\n                rows=\"3\"\n                cols=\"40\"\n                value={searchWords}\n                placeholder={searchWords}\n                spellCheck=\"false\"\n                onChange={(e) => {\n                  setSearchWords(e.target.value);\n                }}\n              ></textarea>\n              <br></br>\n              <button\n                className=\"buttonSmall\"\n                onClick={(e) => {\n                  var sw =\n                    \"Penguin Goat Panda Giraffe PolarBear Lion Tiger Elephant Meerkat Bear Toad Frog Alligator Stork Monkey\";\n                  setSearchWords(sw);\n                }}\n              >\n                Fill with Sample Data\n              </button>\n              <br></br>\n              <br></br>\n              <h5>7. Show instructions</h5>\n              <input\n                type=\"checkbox\"\n                id=\"instructions\"\n                name=\"instructions\"\n                checked={putInstructions}\n                onChange={(e) => {\n                  setPutInstructions(e.target.checked);\n                  //console.log(e);\n                }}\n              ></input>\n              <label htmlFor=\"instructions\">\n                {\" \"}\n                Check this box if you want instructions to appear below the\n                puzzle.\n              </label>\n              <br></br>\n              <button\n                className=\"button\"\n                onClick={(e) => {\n                  if (processSearchWords())\n                    preparePuzzle(searchInstructions, \"no clues\", \"search\");\n                  resetCanvas();\n                }}\n              >\n                Create My Puzzle\n              </button>\n              <br></br>\n              <br></br>\n            </div>\n          </div>\n          <div className=\"column-right\" id=\"div-puzzle-output\">\n            <div id=\"puzzle-operations\">\n              <button\n                id=\"btnReload\"\n                className=\"hor-button\"\n                onClick={(e) => {\n                  if (currentPuzzle.current === \"cross\") {\n                    preparePuzzle(crossInstructiions, \"no clues\", \"cross\");\n                  }\n                  if (currentPuzzle.current === \"search\") {\n                    preparePuzzle(searchInstructions, \"no clues\", \"search\");\n                  }\n                  if (currentPuzzle.current === \"double\") {\n                    preparePuzzle(doubleInstructions, \"no clues\", \"double\");\n                  }\n                  if (currentPuzzle.current === \"fallen\") {\n                    if (processFallenWords()) {\n                      preparePuzzle(fallenInstructions, \"clues\", \"fallen\");\n                    }\n                  }\n                  if (currentPuzzle.current === \"math\") {\n                    if (processMathSquares()) {\n                      preparePuzzle(mathInstructions, \"clues\", \"math\");\n                    }\n                  }\n                  if (currentPuzzle.current === \"letter\") {\n                    if (processLetterTiles()) {\n                      preparePuzzle(letterInstructions, \"clues\", \"letter\");\n                    }\n                  }\n                  if (currentPuzzle.current === \"number\") {\n                    if (processNumberBlocks()) {\n                      preparePuzzle(numberBlockInstructions, \"clues\", \"number\");\n                    }\n                  }\n                  if (currentPuzzle.current === \"hidden\") {\n                    console.log(searchGrid.current);\n                    if (processHiddenMessage()) {\n                      preparePuzzle(hiddenInstructions, \"clues\", \"hidden\");\n                    }\n                  }\n                  if (currentPuzzle.current === \"crypto\") {\n                    if (processCryptoWords()) {\n                      preparePuzzle(cryptoInstructions, \"clues\", \"crypto\");\n                    }\n                  }\n                  resetCanvas();\n                }}\n              >\n                RELOAD PUZZLE\n              </button>\n              <button\n                id=\"btnAnswer\"\n                className=\"hor-button\"\n                onClick={(e) => {\n                  if (currentPuzzle.current === \"cross\") showCrossAnswer();\n                  if (currentPuzzle.current === \"search\") showSearchAnswer();\n                  if (currentPuzzle.current === \"double\") showDoubleAnswer();\n                  if (currentPuzzle.current === \"fallen\") showFallenAnswer();\n                  if (currentPuzzle.current === \"math\") showMathAnswer();\n                  if (currentPuzzle.current === \"letter\") showLetterAnswer();\n                  if (currentPuzzle.current === \"number\") showNumberAnswer();\n                  if (currentPuzzle.current === \"crypto\") showCryptoAnswer();\n                  if (currentPuzzle.current === \"hidden\") {\n                    showHiddenAnswer();\n                  }\n                }}\n              >\n                SHOW ANSWER\n              </button>\n              <button\n                id=\"btnPrint\"\n                className=\"hor-button\"\n                onClick={(e) => {\n                  printPuzzle();\n                }}\n              >\n                PRINT PUZZLE\n              </button>\n              <button\n                id=\"btnCopyPuzzle\"\n                className=\"hor-button\"\n                onClick={(e) => {\n                  writeClipCanvas(\"puzzle-canvas\");\n                }}\n              >\n                COPY PUZZLE\n              </button>\n              <button\n                id=\"btnCopyAnswer\"\n                className=\"hor-button\"\n                onClick={(e) => {\n                  writeClipCanvas(\"answer-canvas\");\n                }}\n              >\n                COPY ANSWER\n              </button>\n            </div>\n            <div id=\"puzzle-instructions\"></div>\n            <div id=\"puzzle-container\">\n              <canvas id=\"puzzle-canvas\" width={910} height={800}></canvas>\n              <canvas id=\"answer-canvas\" width={910} height={800}></canvas>\n            </div>\n            <div id=\"puzzle-clues\"></div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}